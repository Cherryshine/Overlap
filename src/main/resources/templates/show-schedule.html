<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>OverLap - ë©”ì¸ ëœë”©í˜ì´ì§€</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
    <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>
    <script src="/js/layout.js"></script>
    <style>
        .glass-effect {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 1rem; /* ë™ì¼í•œ ê³¡ë¥ ì„ ì ìš© */
        }
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
            100% { transform: translateY(0); }
        }
        .logo-animation {
            animation: float 2s ease-in-out infinite;
        }
        .full-screen {
            min-height: 100vh;
        }
        .chat-message {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.7s ease, transform 0.7s ease;
        }
        @keyframes expand {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        .animate-expand {
            animation: expand 0.6s ease-out;
            transform-origin: top;
        }

        /* ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ */
        .btn-animate {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.7s ease, transform 0.7s ease;
        }
        .btn-show {
            opacity: 1;
            transform: translateY(0);
        }

        /* ì „ì²´ ë ˆì´ì•„ì›ƒì„ flexë¡œ ì„¤ì •í•˜ì—¬ í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
        body, html {
            height: auto;  /* ê³ ì • ë†’ì´ ëŒ€ì‹  ìë™ìœ¼ë¡œ ì¡°ì • */
            margin: 0;
            display: flex;
            flex-direction: column;
        }

        .content {
            flex-grow: 1;
            min-height: 100vh;  /* ì»¨í…ì¸ ì˜ ìµœì†Œ ë†’ì´ ì„¤ì • */
        }

        footer {
            margin-top: auto; /* í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
        }

        /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ ì„¤ì • */
        body {
            background-size: 100% auto;  /* ë„ˆë¹„ 100%, ë†’ì´ëŠ” ìë™ìœ¼ë¡œ ì¡°ì • */
            background-repeat: no-repeat;
            min-height: 100%;  /* ìµœì†Œ ë†’ì´ë¥¼ 100%ë¡œ ì„¤ì • */
        }

        /* 320px ì´í•˜ í™”ë©´ì—ì„œ ë²„íŠ¼ í…ìŠ¤íŠ¸ í¬ê¸°ë¥¼ 12pxë¡œ ì ìš© (Tailwindë³´ë‹¤ ìš°ì„ ìˆœìœ„ë¥¼ ë†’ì„) */
        @media (max-width: 320px) {
            button.btn-responsive-text {
                font-size: 12px !important;
            }
        }

        /* ë°˜ì‘í˜• ë²„íŠ¼ í°íŠ¸: ë·°í¬íŠ¸ ë„ˆë¹„ê°€ 320pxì—ì„œëŠ” 12px, 640px ì´ìƒì—ì„œëŠ” 16pxë¡œ ì„ í˜• ë³´ê°„ */
        .btn-responsive-font {
            font-size: clamp(12px, calc(12px + ((100vw - 320px) / 80)), 16px) !important;
        }
    </style>
    <script src="https://cdn.tailwindcss.com/3.3.2"></script>

    <style>
        /* iOSì—ì„œ ë”ë¸”íƒ­ í™•ëŒ€ ë°©ì§€ */
        * {
            touch-action: manipulation;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        /* í˜ì´ì§€ ë²„íŠ¼ (ê³µí†µ) */
        .page-button {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 4px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ ì‚¬ê°í˜• í˜•íƒœ */
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
            cursor: pointer;
            flex-shrink: 0;
        }

        .page-button:disabled {
            opacity: 0.5;
            cursor: default;
        }

        /* ìŠ¤í¬ë¡¤ ì˜ì—­ ë‚´ì— ìƒë‹¨ê³¼ í•˜ë‹¨ì— ê³ ì •ë  ë²„íŠ¼ */
        .page-button-prev {
            position: sticky;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        .page-button-next {
            position: sticky;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        /* ë°˜ì‘í˜• ì„¤ì • */
        @media (max-width: 629px) {
            .page-button {
                width: 28px;
                height: 28px;
            }
        }
        .grid-cell {
            position: relative;
            overflow: hidden;
        }

        /* ì‹œê°„ êµ¬ë¶„ì„ ì„ ìœ„í•œ ê°€ìƒ ìš”ì†Œ */
        .grid-cell::before {
            content: '';
            position: absolute;

            left: -8px; /* ë¶€ëª¨ì˜ íŒ¨ë”©ë§Œí¼ ìŒìˆ˜ê°’ */
            right: -8px; /* ë¶€ëª¨ì˜ íŒ¨ë”©ë§Œí¼ ìŒìˆ˜ê°’ */
            top: 0;
            height: 1px;
            background-color: rgb(209, 213, 219);
            z-index: 1;
        }

        /* ì‹œê°„ëŒ€ êµ¬ë¶„ì„ (ê²€ì€ìƒ‰ êµµì€ ì„ )ì˜ ê²½ìš° */
        .grid-cell.hour-mark::before {
            height: 1.2px;
            background-color: rgb(157, 101, 203);
        }

        /* ì²« ë²ˆì§¸ í–‰ì˜ ì…€ì€ border ì œê±° */
        .grid-row-first .grid-cell::before {
            display: none;
        }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .skeleton-loader {
            position: relative;
            background: #f0e9fb;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(157, 101, 203, 0.08);
        }
        
        /* ë¹› ë§‰ëŒ€ íš¨ê³¼ 1 - ì²« ë²ˆì§¸ ë§‰ëŒ€ */
        .skeleton-loader::after {
            content: '';
            position: absolute;
            top: 0;
            left: -150px;
            height: 100%;
            width: 150px;
            background: linear-gradient(to right, 
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0.5) 50%,
                rgba(255, 255, 255, 0) 100%
            );
            animation: shimmer-wave 1.5s cubic-bezier(0.4, 0.0, 0.2, 1) infinite;
        }
        
        /* ë¹› ë§‰ëŒ€ íš¨ê³¼ 2 - ë‘ ë²ˆì§¸ ë§‰ëŒ€ (ì‹œì°¨ë¥¼ ë‘ ) */
        .skeleton-loader::before {
            content: '';
            position: absolute;
            top: 0;
            left: -150px;
            height: 100%;
            width: 150px;
            background: linear-gradient(to right, 
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0.5) 50%,
                rgba(255, 255, 255, 0) 100%
            );
            animation: shimmer-wave 1.5s cubic-bezier(0.4, 0.0, 0.2, 1) 0.75s infinite;
        }
        
        @keyframes shimmer-wave {
            0% {
                transform: translateX(-150px);
            }
            100% {
                transform: translateX(1000px);
            }
        }
        
        /* ì¤‘ì²©ëœ ê·¸ë¦¬ë“œì—ì„œ ì‹œì°¨ë¥¼ ë‘ì§€ ì•Šê³  ë™ì¼í•œ ë¬¼ê²°ì´ ì§€ë‚˜ê°€ë„ë¡ ìˆ˜ì • */
        .loader-container {
            padding: 16px;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }
        
        .loader-header {
            display: flex;
            height: 36px;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .loader-time-column {
            width: 60px;
            margin-right: 12px;
            display: flex;
            flex-direction: column;
            gap: 40px;
        }
        
        .loader-time {
            width: 52px;
            height: 20px;
        }
        
        .loader-grid-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .loader-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 4px;
            margin-bottom: 10px;
        }
        
        .loader-cell {
            height: 26px;
            border-radius: 4px;
        }
        
        /* í„ì‹± íš¨ê³¼ (ì•½ê°„ì˜ í¬ê¸° ë³€í™”) */
        @keyframes pulse {
            0%, 100% {
                transform: scaleY(1);
            }
            50% {
                transform: scaleY(0.97);
            }
        }
        
        .skeleton-loader {
            animation: pulse 3s ease-in-out infinite;
        }
        
        /* ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(8px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .loader-container {
            animation: fadeIn 0.3s ease-out forwards;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="flex flex-col bg-gradient-to-br from-purple-200 via-purple-300 to-purple-400">

<div th:replace="~{/navigation-bar :: nav}"></div>

<!-- main íƒœê·¸ë¡œ ì½˜í…ì¸  ì˜ì—­ì„ ê°ì‹¸ flex-grow ì†ì„±ì„ ì ìš© -->
<main class="content pt-[84px] sm:pt-[150px]">
    <div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-[60px] pb-[50px] max-w-4xl">
        <div class="glass-effect rounded-3xl p-8 text-center">
            <!-- ì¼ì • ì œëª© -->
            <p class="text-purple-800 mb-[15px] text-3xl"><a class="text-purple-800 mb-[15px] font-bold text-3xl">ëŒ€ë©´íšŒì˜</a> ê·¸ë£¹ ì¼ì •</p>
            <!-- íƒ€ì„ í…Œì´ë¸” -->
            <div id="app" class="max-w-5xl w-full p-4 bg-purple-50 rounded-lg shadow relative">
                <!-- ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ -->
                <div id="scheduleLoader" class="loader-container">
                    <!-- í—¤ë” ìŠ¤ì¼ˆë ˆí†¤ -->
                    <div class="loader-header">
                        <div class="skeleton-loader w-16"></div>
                        <div class="skeleton-loader flex-1"></div>
                    </div>
                    
                    <!-- ì‹œê°„í‘œ ë³¸ë¬¸ -->
                    <div class="flex">
                        <!-- ì‹œê°„ ë§ˆì»¤ ì—´ -->
                        <div class="loader-time-column">
                            <div class="loader-time skeleton-loader"></div>
                            <div class="loader-time skeleton-loader"></div>
                            <div class="loader-time skeleton-loader"></div>
                            <div class="loader-time skeleton-loader"></div>
                        </div>
                        
                        <!-- ê·¸ë¦¬ë“œ ìŠ¤ì¼ˆë ˆí†¤ -->
                        <div class="loader-grid-container">
                            <!-- ë°˜ë³µë˜ëŠ” í–‰ 7ê°œ (ì‹œê°„ëŒ€ë³„) -->
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                            <div class="loader-grid">
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                                <div class="loader-cell skeleton-loader"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- (1) ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë¡œë“œ -->
            <script src="/js/schedule.js"></script>

            <!-- (2) JSON ë°ì´í„° ë° ì´ˆê¸°í™” ë¡œì§ -->
            <script>
                // ì„œë²„ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
                async function fetchScheduleData() {
                    try {
                        // ë¡œë” í‘œì‹œ
                        document.getElementById('scheduleLoader').classList.remove('hidden');
                        
                        // ì°¸ì—¬ì ë¦¬ìŠ¤íŠ¸ì™€ ê°€ëŠ¥í•œ ì‹œê°„ëŒ€ë¥¼ í¬í•¨í•œ ë”ë¯¸ ë°ì´í„°
                        const data = {
                            startTime: "11:00",
                            endTime: "16:00",
                            interval: 15,
                            days: [
                                { label: "ì›”", date: "2ì›” 12ì¼" },
                                { label: "í™”", date: "2ì›” 13ì¼" },
                                { label: "ìˆ˜", date: "2ì›” 14ì¼" },
                                { label: "ëª©", date: "2ì›” 15ì¼" },
                                { label: "ê¸ˆ", date: "2ì›” 16ì¼" }
                            ],
                            participants: [
                                { name: "ì§€ìˆ˜", id: 1 },
                                { name: "ë¯¼êµ¬", id: 2 },
                                { name: "ì„±ë¬¸", id: 3 },
                                { name: "ì•„í˜„", id: 4 },
                                { name: "ë¯¼ì§€", id: 5 },
                                { name: "í•˜ë‹ˆ", id: 6 },
                                { name: "í˜œì¸", id: 7 },
                                { name: "ë‹¤ë‹ˆì—˜", id: 8 },
                                { name: "í˜œë¦°", id: 9 },
                                { name: "í•œêµ­", id: 10 },
                                { name: "ì§€í—Œ", id: 11 },
                                { name: "í•˜ë£¨", id: 12 }
                            ],
                            // ê°€ìš©ì„± ë°ì´í„°ë¥¼ ì…€ ìƒ‰ìƒ ì •ë³´ë¡œ ë³€í™˜
                            availabilityColors: {}
                        };
                        
                        // ê° ë‚ ì§œë³„, ì‹œê°„ë³„ ì°¸ì—¬ì ê°€ìš©ì„± ë°ì´í„°
                        const availability = {
                            "ì›”_11:00": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], // ëª¨ë‘ ì°¸ì—¬ ê°€ëŠ¥
                            "ì›”_11:15": [1, 2, 3, 8, 9, 10, 11, 12],    // 8ëª… ì°¸ì—¬ ê°€ëŠ¥
                            "ì›”_11:30": [2, 3, 4, 5, 6],       // 5ëª… ì°¸ì—¬ ê°€ëŠ¥
                            "ì›”_11:45": [4, 7, 9],          // 3ëª…ë§Œ ì°¸ì—¬ ê°€ëŠ¥
                            "ì›”_12:00": [1, 2, 4, 7, 8, 9],
                            "ì›”_13:30": [1, 3, 4, 5, 11, 12],
                            "í™”_11:00": [1, 2, 7, 8, 9, 10],
                            "í™”_11:15": [2, 3, 4, 5, 6, 7, 8],
                            "í™”_14:00": [1, 2, 3, 4, 5, 6, 7, 8, 9],
                            "ìˆ˜_11:00": [3, 4, 10, 11, 12],
                            "ìˆ˜_13:00": [1, 2, 3, 5, 6, 7],
                            "ëª©_11:45": [1, 4, 5, 6, 8, 9, 10],
                            "ëª©_15:00": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
                            "ê¸ˆ_11:30": [2, 3, 4, 7, 8, 9, 10],
                            "ê¸ˆ_11:45": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                        };
                        
                        // ê°€ìš©ì„± ë°ì´í„°ë¥¼ ì…€ ìƒ‰ìƒìœ¼ë¡œ ë³€í™˜
                        const totalParticipants = data.participants.length;
                        
                        // ê° ì…€ ë°ì´í„° ìƒ‰ìƒ ë° ì •ë³´ ìƒì„±
                        for (let day of data.days) {
                            let currentHour = 9;  // ì‹œì‘ ì‹œê°„(9ì‹œ)
                            let currentMinute = 0;
                            
                            while (currentHour < 16 || (currentHour === 16 && currentMinute === 0)) {
                                // ì‹œê°„ í˜•ì‹ í¬ë§·íŒ…
                                const formattedHour = currentHour.toString().padStart(2, '0');
                                const formattedMinute = currentMinute.toString().padStart(2, '0');
                                const formattedTime = `${formattedHour}:${formattedMinute}`;
                                
                                // ê°€ìš©ì„± í‚¤ ìƒì„± (ìš”ì¼_ì‹œê°„)
                                const availabilityKey = `${day.label}_${formattedTime}`;
                                const availableUsers = availability[availabilityKey] || [];
                                
                                if (availableUsers.length > 0) {
                                    // ì°¸ì—¬ ê°€ëŠ¥í•œ ì‚¬ëŒ ë¹„ìœ¨ ê³„ì‚°
                                    const ratio = availableUsers.length / totalParticipants;
                                    
                                    // HSL ìƒ‰ìƒ ê³„ì‚° - ë³´ë¼ìƒ‰(270) ìœ ì§€í•˜ë˜ ê´‘ë„ ì¡°ì •
                                    const saturation = 70 + (30 * ratio); 
                                    // ê°€ì¥ ì§„í•œ ìƒ‰ì˜ ê´‘ë„ ëŠ˜ë¦¼ (ìµœì†Œê°’ 45%ë¡œ ë³€ê²½)
                                    const lightness = 90 - (45 * ratio);
                                    
                                    // ì…€ í‚¤ ìƒì„±
                                    const cellKey = `${day.label}_${formattedTime}`;
                                    
                                    // ë°°ê²½ìƒ‰ ì„¤ì • ë° í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì •ë³´ ì¶”ê°€
                                    data.availabilityColors[cellKey] = {
                                        backgroundColor: `hsl(270, ${saturation}%, ${lightness}%)`,
                                        title: `ì°¸ì—¬ ê°€ëŠ¥: ${availableUsers.length}/${totalParticipants}`,
                                        participantIds: availableUsers,
                                        // í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì •ë³´ ì¶”ê°€ (ì–´ë‘ìš´ ì…€ì—ë§Œ í°ìƒ‰ ì ìš©)
                                        textColor: ratio > 0.5 ? 'white' : 'black'
                                    };
                                }
                                
                                // ë‹¤ìŒ ì‹œê°„ëŒ€ë¡œ ì´ë™
                                currentMinute += data.interval;
                                if (currentMinute >= 60) {
                                    currentHour += Math.floor(currentMinute / 60);
                                    currentMinute %= 60;
                                }
                            }
                        }
                        
                        // ë°ì´í„° ì„¤ì •
                        window.jsonData = data;
                        
                        // ë¡œë” ìˆ¨ê¸°ê¸°
                        document.getElementById('scheduleLoader').classList.add('hidden');
                        
                        // ì¼ì • ì •ë³´ í‘œì‹œ ì˜ì—­ ì¶”ê°€
                        if (!document.getElementById('selectedCellInfo')) {
                            const infoDiv = document.createElement('div');
                            infoDiv.id = 'selectedCellInfo';
                            infoDiv.className = 'mt-4 p-6 bg-white rounded-lg shadow text-center border-2 border-purple-300 border-dashed flex items-center justify-center min-h-[120px]';
                            infoDiv.innerHTML = `
                                <div class="text-gray-500 text-md">
                                    <i class="fas fa-info-circle text-purple-500 mr-2"></i>
                                    ì„ íƒëœ ì…€ì´ ì—†ì–´ìš”. ì…€ì„ ì„ íƒí•˜ì‹œë©´ ê°€ëŠ¥í•œ ì¸ì›ì´ ì—¬ê¸°ì— í‘œì‹œë¼ìš”.
                                </div>
                            `;
                            document.getElementById('app').insertAdjacentElement('afterend', infoDiv);
                        }
                        
                        // ê¸°ì¡´ schedule.jsì˜ updateSchedule í•¨ìˆ˜ í˜¸ì¶œ
                        updateSchedule();
                        
                        // ì…€ì— ìƒ‰ìƒ ì ìš© ë° íˆ´íŒ ì¶”ê°€
                        setTimeout(applyAvailabilityColors, 100);
                        
                    } catch (error) {
                        console.error('ì¼ì • ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                        
                        // ê°„ë‹¨í•œ ì˜¤ë¥˜ ëŒ€ì²´ ë°ì´í„°
                            window.jsonData = {
                                startTime: "09:00",
                                endTime: "16:00",
                                interval: 15,
                                days: [
                                { label: "ì›”", date: "2ì›” 12ì¼" },
                                { label: "í™”", date: "2ì›” 13ì¼" },
                                { label: "ìˆ˜", date: "2ì›” 14ì¼" }
                            ],
                            participants: [
                                { name: "ì§€ìˆ˜", id: 1 },
                                { name: "ë¯¼êµ¬", id: 2 }
                                ]
                            };
                            
                            // ë¡œë” ìˆ¨ê¸°ê¸°
                            document.getElementById('scheduleLoader').classList.add('hidden');
                            
                            // ìŠ¤ì¼€ì¤„ ì—…ë°ì´íŠ¸
                            updateSchedule();
                    }
                }
                
                // ìƒì„±ëœ ì…€ì— ê°€ìš©ì„± ìƒ‰ìƒ ì ìš© ë° íˆ´íŒ, í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                function applyAvailabilityColors() {
                    if (!window.jsonData || !window.jsonData.availabilityColors) return;
                    
                    const colors = window.jsonData.availabilityColors;
                    const participants = window.jsonData.participants || [];
                    
                    document.querySelectorAll('.grid-cell').forEach(cell => {
                        // ì…€ì˜ ìœ„ì¹˜ ì •ë³´ ì¶”ì¶œ
                        const days = window.jsonData.days;
                        const startTimeObj = parseTimeString(window.jsonData.startTime);
                        const startTotalMin = toTotalMinutes(startTimeObj.hour, startTimeObj.minute);
                        
                        // ì´ë²¤íŠ¸ ë°œìƒ ì…€ ìœ„ì¹˜ íŒŒì•…
                        const cellIndex = Array.from(cell.parentNode.children).indexOf(cell) - 1;
                        if (cellIndex < 0) return; // ì‹œê°„ ì—´ ì œì™¸
                        
                        const rowParent = cell.closest('div[class*="grid-cols-"]') || cell.parentNode;
                        const dayIndex = cellIndex % days.length;
                        if (dayIndex < 0 || dayIndex >= days.length) return;
                        
                        const day = days[dayIndex].label;
                        
                        // ì‹œê°„ ê³„ì‚°: ì…€ì˜ í–‰ ì¸ë±ìŠ¤ì— ê°„ê²©ì„ ê³±í•˜ì—¬ ì‹œì‘ ì‹œê°„ë¶€í„° ì˜¤í”„ì…‹
                        const rowIndex = Math.floor(Array.from(rowParent.parentNode.children).indexOf(rowParent));
                        const timeOffset = rowIndex * window.jsonData.interval;
                        const cellTimeMinutes = startTotalMin + timeOffset;
                        const formattedTime = formatTime24(cellTimeMinutes);
                        
                        // ì…€ í‚¤ ìƒì„±
                        const cellKey = `${day}_${formattedTime}`;
                        
                        // ê°€ìš©ì„± ìƒ‰ìƒ ì •ë³´ê°€ ìˆìœ¼ë©´ ì ìš©
                        if (colors[cellKey]) {
                            cell.style.backgroundColor = colors[cellKey].backgroundColor;
                            
                            // ì°¸ì—¬ì ìˆ˜ í‘œì‹œ
                            const participantIds = colors[cellKey].participantIds || [];
                            
                            // ê¸°ì¡´ í…ìŠ¤íŠ¸ ì œê±°
                            const existingText = cell.querySelector('span');
                            if (existingText) {
                                cell.removeChild(existingText);
                            }
                            
                            const countText = document.createElement('span');
                            // í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì„¤ì •
                            const textColor = colors[cellKey].textColor || 'black';
                            countText.className = `text-xs font-medium ${textColor === 'white' ? 'text-white' : 'text-gray-800'}`;
                            countText.textContent = `${participantIds.length}/${participants.length}`;
                            cell.appendChild(countText);
                            
                            // íˆ´íŒì— ì°¸ì—¬ì ì´ë¦„ ì¶”ê°€
                            if (participantIds.length > 0) {
                                const names = participantIds.map(id => {
                                    const participant = participants.find(p => p.id === id);
                                    return participant ? participant.name : "ì•Œ ìˆ˜ ì—†ìŒ";
                                });
                                
                                // ì¢…ë£Œ ì‹œê°„ ê³„ì‚° (15ë¶„ í›„)
                                const endTime = calculateEndTime(formattedTime, 15);
                                const timeRange = `${formattedTime}-${endTime}`;
                                
                                let tooltipText;
                                if (names.length <= 3) {
                                    tooltipText = `${timeRange} ì°¸ì—¬ ê°€ëŠ¥: ${names.join(", ")}`;
                                } else {
                                    tooltipText = `${timeRange} ì°¸ì—¬ ê°€ëŠ¥: ${names.slice(0, 3).join(", ")} ì™¸ ${names.length - 3}ëª…`;
                                }
                                
                                cell.title = tooltipText;
                                
                                // ë°ì´í„° ì†ì„±ì— ëª¨ë“  ì •ë³´ ì €ì¥
                                cell.dataset.day = day;
                                cell.dataset.time = formattedTime;
                                cell.dataset.participantIds = JSON.stringify(participantIds);
                                
                                // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                                cell.addEventListener('click', function() {
                                    showParticipantInfo(this);
                                });
                            }
                        }
                    });
                }
                
                // ì…€ í´ë¦­ ì‹œ ì°¸ì—¬ì ì •ë³´ í‘œì‹œ
                function showParticipantInfo(cell) {
                    const infoDiv = document.getElementById('selectedCellInfo');
                    if (!infoDiv) return;
                    
                    // ë¨¼ì € ëª¨ë“  ì…€ì˜ ìŠ¤íƒ€ì¼ì„ ì´ˆê¸°í™”
                    document.querySelectorAll('.grid-cell').forEach(cell => {
                        // ëª¨ë“  ì¶”ê°€ ìŠ¤íƒ€ì¼ ì†ì„± ì œê±°
                        cell.style.boxShadow = '';
                        cell.style.borderRadius = '';
                        cell.style.position = '';
                        cell.style.zIndex = '';
                        cell.classList.remove('selected');
                    });
                    
                    // ì„ íƒëœ ì…€ì— ê°•ì¡° íš¨ê³¼ ì ìš©
                    cell.classList.add('selected');
                    
                    // ë‚´ë¶€ í…Œë‘ë¦¬ íš¨ê³¼ëŠ” ìœ ì§€í•˜ê³  ì™¸ë¶€ ê·¸ë¦¼ìë§Œ ì œê±°
                    cell.style.boxShadow = `inset 0 0 0 3px #40A9FF`; // ë‚´ë¶€ í…Œë‘ë¦¬ íš¨ê³¼ë§Œ ìœ ì§€ (íŒŒë€ìƒ‰)
                    
                    cell.style.borderRadius = '6px'; // ë‘¥ê·¼ í…Œë‘ë¦¬ íš¨ê³¼
                    cell.style.position = 'relative'; // ìƒëŒ€ì  ìœ„ì¹˜ ì„¤ì •
                    cell.style.zIndex = '2';
                    
                    // ì…€ ë°ì´í„° ì¶”ì¶œ
                    const day = cell.dataset.day;
                    const time = cell.dataset.time;
                    const participantIds = JSON.parse(cell.dataset.participantIds || '[]');
                    
                    // ì¢…ë£Œ ì‹œê°„ ê³„ì‚° (15ë¶„ í›„)
                    const endTime = calculateEndTime(time, 15);
                    const timeRange = `${time}-${endTime}`;
                    
                    if (participantIds.length === 0) {
                        infoDiv.innerHTML = '<p class="text-gray-500">ì´ ì‹œê°„ì—ëŠ” ì°¸ì—¬ ê°€ëŠ¥í•œ ì¸ì›ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                        infoDiv.className = 'mt-4 p-6 bg-white rounded-lg shadow text-left';
                        return;
                    }
                    
                    // ì°¸ì—¬ì ì •ë³´ êµ¬ì„±
                    const participants = window.jsonData.participants || [];
                    const participantInfos = participantIds.map(id => {
                        const participant = participants.find(p => p.id === id);
                        return participant ? participant.name : "ì•Œ ìˆ˜ ì—†ìŒ";
                    });
                    
                    // HTML êµ¬ì„±
                    let html = `
                        <h3 class="font-bold text-lg text-purple-800">${day}ìš”ì¼ ${timeRange}</h3>
                        <p class="mb-2 text-gray-600">ì°¸ì—¬ ê°€ëŠ¥í•œ ì¸ì›: ${participantIds.length}ëª…</p>
                        <div class="flex flex-wrap gap-2">
                    `;
                    
                    // ì°¸ì—¬ì íƒœê·¸ ì¶”ê°€
                    participantInfos.forEach(name => {
                        html += `<span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-sm">${name}</span>`;
                    });
                    
                    html += `</div>`;
                    
                    // ì •ë³´ í‘œì‹œ - í´ë˜ìŠ¤ë„ ì—…ë°ì´íŠ¸í•˜ì—¬ ì ì„  í…Œë‘ë¦¬ ì œê±°
                    infoDiv.innerHTML = html;
                    infoDiv.className = 'mt-4 p-6 bg-white rounded-lg shadow text-left';
                }
                
                // ì¢…ë£Œ ì‹œê°„ ê³„ì‚° í•¨ìˆ˜ (ì‹œì‘ ì‹œê°„ì—ì„œ minutes ë¶„ í›„)
                function calculateEndTime(startTime, minutes) {
                    const [hours, mins] = startTime.split(':').map(Number);
                    
                    // ë¶„ ë‹¨ìœ„ë¡œ ë³€í™˜í•˜ê³  minutesë¥¼ ë”í•œ ë‹¤ìŒ ë‹¤ì‹œ ì‹œê°„ê³¼ ë¶„ìœ¼ë¡œ ë³€í™˜
                    let totalMinutes = hours * 60 + mins + minutes;
                    const newHours = Math.floor(totalMinutes / 60);
                    const newMins = totalMinutes % 60;
                    
                    // ì‹œê°„ê³¼ ë¶„ì„ ë‘ ìë¦¬ ë¬¸ìì—´ë¡œ í¬ë§·íŒ…
                    const formattedHours = newHours.toString().padStart(2, '0');
                    const formattedMins = newMins.toString().padStart(2, '0');
                    
                    return `${formattedHours}:${formattedMins}`;
                }
                
                // ì‹œê°„ ê´€ë ¨ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
                function parseTimeString(str) {
                    const [hh, mm] = str.split(":");
                    return { hour: parseInt(hh, 10), minute: parseInt(mm, 10) };
                }
                
                function toTotalMinutes(h, m) {
                    return h * 60 + m;
                }
                
                function formatTime24(totalMin) {
                    const h = Math.floor(totalMin / 60);
                    const min = totalMin % 60;
                    const hh = h < 10 ? "0" + h : "" + h;
                    const mm = min < 10 ? "0" + min : "" + min;
                    return `${hh}:${mm}`;
                }
                
                // ì›ë˜ updateSchedule í•¨ìˆ˜ í˜¸ì¶œ ì „ì— ìˆ˜ì •ë²„ì „ ì‚¬ìš©ì„ ìœ„í•œ íŒ¨ì¹˜
                const originalUpdateSchedule = window.updateSchedule;
                window.updateSchedule = function() {
                    const result = originalUpdateSchedule.apply(this, arguments);
                    
                    // ìš”ì¼ í‘œì‹œ ìˆ˜ì • - labelì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
                    document.querySelectorAll('.text-sm.text-gray-500').forEach(el => {
                        // undefined ìš”ì¼ í…ìŠ¤íŠ¸ ì²˜ë¦¬
                        if (el.textContent.includes('undefined')) {
                            // ì›ë³¸ ë°ì´í„°ì—ì„œ ìš”ì¼ ì¶”ì¶œ
                            const dayIndex = Array.from(el.closest('.grid').querySelectorAll('.text-center')).indexOf(el.closest('.text-center'));
                            if (dayIndex >= 0 && window.jsonData.days[dayIndex]) {
                                el.textContent = `${window.jsonData.days[dayIndex].label}ìš”ì¼`;
                            }
                        }
                    });
                    
                    // ë‚ ì§œ í‘œì‹œ ìˆ˜ì •
                    document.querySelectorAll('.text-lg.font-semibold').forEach(el => {
                        // undefined í…ìŠ¤íŠ¸ ì²˜ë¦¬
                        if (el.textContent.includes('undefined')) {
                            // ì›ë³¸ ë°ì´í„°ì—ì„œ ë‚ ì§œ ì¶”ì¶œ
                            const dayIndex = Array.from(el.closest('.grid').querySelectorAll('.text-center')).indexOf(el.closest('.text-center'));
                            if (dayIndex >= 0 && window.jsonData.days[dayIndex]) {
                                // ì´ë¯¸ "2ì›” 12ì¼" í˜•ì‹ìœ¼ë¡œ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ê·¸ëŒ€ë¡œ ì‚¬ìš©
                                el.textContent = window.jsonData.days[dayIndex].date;
                            }
                        }
                    });
                    
                    return result;
                };
                
                // í˜ì´ì§€ ë¡œë“œ ì‹œ í˜¸ì¶œí•˜ëŠ” ì½”ë“œëŠ” ê¸°ì¡´ ì½”ë“œ ìœ ì§€
                let currentPage = 0;
                let itemsPerPage = window.innerWidth <= 629 ? 3 : 5;

                document.addEventListener("DOMContentLoaded", function () {
                    // ì„œë²„ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    fetchScheduleData();

                    // ë°˜ì‘í˜• ë¦¬ì‚¬ì´ì§• ê°ì§€
                    window.addEventListener("resize", function () {
                        const newItemsPerPage = window.innerWidth <= 629 ? 3 : 5;
                        if (newItemsPerPage !== itemsPerPage) {
                            itemsPerPage = newItemsPerPage;
                            currentPage = 0;
                            updateSchedule();
                            // ì…€ ìƒ‰ìƒ ë‹¤ì‹œ ì ìš©
                            setTimeout(applyAvailabilityColors, 100);
                        }
                    });
                });
            </script>
            <!-- ë²„íŠ¼ ê·¸ë£¹ -->
            <div class="flex flex-col sm:flex-row justify-center gap-4 md-[30px] mt-[15px]">
                <button id="shareButton" class="bg-purple-700 text-white btn-responsive-font py-2 font-bold px-6 rounded hover:bg-purple-700 transition-colors">
                    ô€ˆ‚ ê³µìœ í•˜ê¸°
                </button>

                <button class="bg-[#FEE500] text-[#191919] btn-responsive-font py-2 px-6 font-bold rounded hover:bg-[#FEE500] transition-colors" id="kakao-login" onclick="redirectKakao()">
                    ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸í•˜ê³  ë‚´ ì¼ì • ë“±ë¡í•˜ê¸°
                </button>

                <button class="bg-purple-700 text-white btn-responsive-font py-2 font-bold px-6 rounded hover:bg-purple-700 transition-colors" id="kakao-calendar-auth" >
                    ë‚´ ì¼ì • ë“±ë¡í•˜ê¸°
                </button>

                <button class="bg-[#FEE500] text-[#191919] btn-responsive-font py-2 px-6 font-bold rounded hover:bg-[#FEE500] transition-colors" id="kakao-calendar" onclick="window.location.href = '/test/token'">
                    í†¡ìº˜ë¦°ë”
                </button>

            </div>


        </div>
    </div>
</main>

<footer class="bg-purple-800 text-white py-6">
    <div class="container mx-auto text-center">
        <p class="text-sm">&copy; Made with ğŸ’œ by í¼í”Œì½”ë“œë©ìŠ¤</p>
    </div>
</footer>

<script>




function redirectKakao() {
const clientId = "e6c0d0aedffcb33efa50bd47deba9e3d"; // ì¹´ì¹´ì˜¤ REST API í‚¤
const redirectUri = encodeURIComponent("https://localhost:443/oauth/kakao/callback");
const kakaoAuthUrl =
`https://kauth.kakao.com/oauth/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=code&scope=friends,profile_image,profile_nickname,talk_calendar,talk_message`;

window.location.href = kakaoAuthUrl;
}

document.addEventListener('DOMContentLoaded', function() {
// í˜ì´ì§€ê°€ ë¡œë“œëœ í›„ ì ì‹œ ì§€ì—°ì„ ì£¼ì–´ ìŠ¤í¬ë¡¤ ì´ë™
        setTimeout(function() {
            window.scrollTo(0, 0); // ìŠ¤í¬ë¡¤ì„ ìµœìƒë‹¨ìœ¼ë¡œ
        }, 100); // 100ms ì •ë„ ì§€ì—°ì‹œì¼œì¤Œìœ¼ë¡œì¨ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ ì•ˆì •í™” í›„ ì‹¤í–‰
    });

    document.getElementById("shareButton").addEventListener("click", async () => {
        try {
            await navigator.share({
                title: 'ê¹€ë¯¼êµ¬ ë©ì²­ì´',
                text: 'ê¹€ë¯¼êµ¬ë°”ë³´ë©ì²­',
                url: 'https://wormwlrm.github.io',
            });
            console.log('ê³µìœ  ì„±ê³µ');
        } catch (e) {
            console.log('ê³µìœ  ì‹¤íŒ¨');
        }
    });

</script>
</body>
</html>

