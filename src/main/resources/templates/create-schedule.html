<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>OverLap - ë©”ì¸ ëœë”©í˜ì´ì§€</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>

  <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
  <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>
  <style>
    .glass-effect {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 1rem; /* ë™ì¼í•œ ê³¡ë¥ ì„ ì ìš© */
    }
    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-2px); }
      100% { transform: translateY(0); }
    }
    .logo-animation {
      animation: float 2s ease-in-out infinite;
    }
    .full-screen {
      min-height: 100vh;
    }
    .chat-message {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    @keyframes expand {
      0% {
        opacity: 0;
        transform: scale(0.5);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }
    .animate-expand {
      animation: expand 0.6s ease-out;
      transform-origin: top;
    }

    /* ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ */
    .btn-animate {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .btn-show {
      opacity: 1;
      transform: translateY(0);
    }

    /* ì „ì²´ ë ˆì´ì•„ì›ƒì„ flexë¡œ ì„¤ì •í•˜ì—¬ í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
    body, html {
      height: auto;  /* ê³ ì • ë†’ì´ ëŒ€ì‹  ìë™ìœ¼ë¡œ ì¡°ì • */
      margin: 0;
      display: flex;
      flex-direction: column;
    }

    .content {
      flex-grow: 1;
    }

    footer {
      margin-top: auto; /* í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
    }

    /* ì»¤ìŠ¤í…€ ë“œë¡­ë‹¤ìš´ */
    .custom-dropdown {
      position: relative;
      width: 100%; /* ë“œë¡­ë‹¤ìš´ ì „ì²´ê°€ ê°€ë¡œí­ì„ 100% ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      z-index: 10;
      display: none;
      background-color: #f4eeff;
      border-radius: 0;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      max-height: 300px;
      overflow-y: auto;
      border-radius: 5px;
      border: 1px solid #ddd;
    }

    .dropdown-menu.show {
      display: block;
    }

    .dropdown-menu a:active,
    .dropdown-menu a:focus {
      background-color: #8b5cf6; /* ë³´ë¼ìƒ‰ */
      color: white; /* ê¸€ì ìƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }

    /* ì„ íƒëœ í•­ëª©ì— ë³´ë¼ìƒ‰ ë°°ê²½ ì¶”ê°€ */
    .dropdown-menu a.selected {
      background-color: #8b5cf6; /* ë³´ë¼ìƒ‰ */
      color: white; /* ê¸€ì ìƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }

    .dropdown-menu a {
      display: block;
      padding: 8px 16px;
      color: #866198;
      text-decoration: none;
      cursor: pointer;
      border-bottom: 0.5px solid #b3a6b9; /* í•­ëª© ì‚¬ì´ì— êµ¬ë¶„ì„  ì¶”ê°€ */
    }

    .dropdown-menu a:last-child {
      border-bottom: none; /* ë§ˆì§€ë§‰ í•­ëª©ì€ êµ¬ë¶„ì„ ì´ ì—†ë„ë¡ ì„¤ì • */
    }

    .dropdown-menu a:hover {
      background-color: #aa8eec;
      color: white;
    }

    .dropdown-wrapper {
      display: flex;
      align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
      width: 100%;
      min-width: 280px; /* ë“œë¡­ë‹¤ìš´ì˜ ìµœì†Œ ë„ˆë¹„ */
    }

    .dropdown-wrapper > .custom-dropdown {
      flex: 1 1 0%; /* ë“œë¡­ë‹¤ìš´ë“¤ì´ ë™ì¼í•œ í¬ê¸°ë¡œ ë¶„ë°°ë¨ */
    }

    .dropdown-wrapper > .text-between {
      display: flex;
      align-items: center;
      justify-content: center;
      width: auto; /* "ë¶€í„°" í…ìŠ¤íŠ¸ê°€ ê°€ìš´ë° ìœ„ì¹˜í•˜ë„ë¡ */
      font-size: 16px;
      color: #650094;
      margin: 0 10px; /* ì¢Œìš° ê°„ê²© ì¶”ê°€ */
    }

    /* ë“œë¡­ë‹¤ìš´ê³¼ "ë¶€í„°" í…ìŠ¤íŠ¸ ì‚¬ì´ì˜ ê°„ê²©ì„ ì¡°ì • */
    .dropdown-wrapper > .custom-dropdown:last-child {
      margin-right: 0; /* ë§ˆì§€ë§‰ ë“œë¡­ë‹¤ìš´ì€ ì˜¤ë¥¸ìª½ ì—¬ë°± ì—†ì• ê¸° */
    }

    .custom-dropdown button {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ ì„¤ì • */
    body {
      background-size: 100% auto;  /* ë„ˆë¹„ 100%, ë†’ì´ëŠ” ìë™ìœ¼ë¡œ ì¡°ì • */
      background-repeat: no-repeat;
      min-height: 100%;  /* ìµœì†Œ ë†’ì´ë¥¼ 100%ë¡œ ì„¤ì • */
    }

    /*
    ìº˜ë¦°ë”
     */

    #calendar {
      width: 100%;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }

    /* ë‹¬ë ¥ í…Œì´ë¸”ì€ ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶° ì¡°ì •í•˜ê³ , ë‚´ë¶€ ì…€ì€ ê³ ì • ë¹„ìœ¨ ìœ ì§€ */
    #calendar table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 3px;
      table-layout: fixed;
    }

    th, td {
      text-align: center;
      vertical-align: middle;
      /* ê¸°ì¡´ì—ëŠ” ê³ ì • í”½ì…€ ê°’(40px, 60px)ìœ¼ë¡œ ì§€ì •ë˜ì–´ ìˆì—ˆìœ¼ë‚˜,
         ë§Œì•½ ì…€ì˜ ì •ì‚¬ê°í˜• ë¹„ìœ¨ì„ ìœ ì§€í•˜ë©´ì„œ ë°˜ì‘í˜•ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ì‹¶ë‹¤ë©´
         aspect-ratio ì†ì„±ì„ í™œìš©í•˜ê±°ë‚˜, ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ë° padding íŠ¸ë¦­ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
       */
    }

    /* í•„ìš”ì— ë”°ë¼ ì•„ë˜ì™€ ê°™ì´ ë¯¸ë””ì–´ ì¿¼ë¦¬ë‚˜ ì¶”ê°€ ìŠ¤íƒ€ì¼ì„ í†µí•´ ì…€ í¬ê¸° ë° ê¸€ì í¬ê¸°ë¥¼ ì¡°ì •í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. */

    .calendar-nav {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 15px;
      gap: 10px;
    }

    .calendar-nav button {
      background-color: #e1bee7;
      border: none;
      color: #4a148c;
      font-size: 1em;
      cursor: pointer;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background-color 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .calendar-nav button:hover {
      background-color: #d1aee7;
    }

    .today-btn {
      background-color: #e1bee7;
      border: none;
      color: #4a148c;
      font-size: 1em;
      cursor: pointer;
      margin: 10px auto 0;
      padding: 5px 15px;
      border-radius: 5px;
      transition: background-color 0.3s;
      display: block;
    }

    .today-btn:hover {
      background-color: #d1aee7;
    }

    .calendar-header {
      font-size: 1.4em;
      color: #4a148c;
      text-align: center;
      flex-grow: 1;
    }

    thead {
      position: relative;
      border-bottom: none;
    }

    th {
      background-color: transparent;
      font-weight: normal;
      border: none;
      border-bottom: 2px solid #9c27b0; /* ìš”ì¼ ì…€ í•˜ë‹¨ í…Œë‘ë¦¬ë§Œ ìœ ì§€ */
      padding-bottom: 8px;
    }

    thead th:nth-child(1) {
      color: red;
    }

    thead th:nth-child(7) {
      color: blue;
    }

    td.empty {
      background-color: transparent;
      cursor: default;
    }

    td.day {
      position: relative;
      overflow: visible;
      padding: 0;
    }

    .circle {
      display: inline-block;
      width: 40px;
      height: 40px;
      line-height: 40px;
      border-radius: 50%;
      text-align: center;
      background-color: #fff;
      transition: background-color 0.3s, color 0.3s;
      box-sizing: border-box;
      position: relative;
      z-index: 1;
    }

    td.day:hover .circle {
      background-color: #f3e5f5;
    }

    td.day.selected .circle {
      background-color: transparent;
      color: #fff;
      position: relative;
      z-index: 1;
    }

    td.day.selected .circle::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 40px;
      height: 40px;
      background-color: rgba(156,39,176,0.5);
      border-radius: 50%;
      z-index: -1;
      transition: all 0.3s;
    }

    td.day.today .circle {
      border: 2px solid #4a148c;
      box-sizing: border-box;
    }

    td.day.today.selected .circle::before {
      top: 2px;
      left: 2px;
      width: calc(100% - 4px);
      height: calc(100% - 4px);
    }

    td.day.group-start .circle {
      width: calc(40px + 3px);
      margin-left: -3px;
      border-radius: 50% 0 0 50%;
    }

    td.day.group-end .circle {
      width: calc(40px + 3px);
      margin-right: -3px;
      border-radius: 0 50% 50% 0;
    }

    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-2px); }
      100% { transform: translateY(0); }
    }

    .logo-animation {
      animation: float 2s ease-in-out infinite;
    }

    .content {
      flex-grow: 1;
    }

    /* ë°˜ì‘í˜• í…Œì´ë¸” ì…€ í¬ê¸° ì¡°ì • */
    @media (min-width: 768px) {
      th, td {
        width: 60px; /* í° í™”ë©´ì—ì„œëŠ” ë” í¬ê²Œ */
        height: 60px;
      }

      .circle {
        width: 60px;
        height: 60px;
        line-height: 60px;
        font-size: 1.1em;
      }

      td.day.selected .circle::before {
        width: 60px;
        height: 60px;
      }

      td.day.group-start .circle {
        width: calc(60px + 3px);
      }

      td.day.group-end .circle {
        width: calc(60px + 3px);
      }

      .calendar-header {
        font-size: 1.6em;
      }

      .calendar-nav button {
        padding: 8px 15px;
        font-size: 1.2em;
      }

      .today-btn {
        padding: 8px 20px;
        font-size: 1.1em;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
      }
    }

    @media (max-width: 767px) {
      th, td {
        width: 40px; /* ì‘ì€ í™”ë©´ì—ì„œëŠ” ë” ì‘ê²Œ */
        height: 40px;
      }

      .circle {
        width: 40px;
        height: 40px;
        line-height: 40px;
        font-size: 0.9em;
      }

      .calendar-header {
        font-size: 1.2em;
      }

      .today-btn {
        padding: 5px 15px;
        font-size: 0.9em;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 3px;
      }

      .today-btn svg {
        width: 14px;
        height: 14px;
      }

      .container {
        padding-left: 10px;
        padding-right: 10px;
      }

      .glass-effect {
        padding: 15px;
      }
    }

    /* ì»¨í…Œì´ë„ˆ ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
    .container {
      min-width: 320px; /* ëª¨ë°”ì¼ ê¸°ê¸°ì˜ ì¼ë°˜ì ì¸ ìµœì†Œ ë„ˆë¹„ */
    }


  </style>
</head>
<body class="bg-gradient-to-br from-purple-200 via-purple-300 to-purple-400">

<div th:replace="~{/nav :: nav}"></div>

<div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-[60px] pt-[84px] sm:pt-[150px] pb-[50px] min-h-[calc(100vh-80px)] max-w-4xl content">
  <!-- ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ë‚´ìš© ì œê±°ë¨ -->
  <div class="glass-effect rounded-3xl p-8">
    <p class="text-purple-800 font-bold mb-[15px] text-2xl">ìƒˆ ì¼ì • ë§Œë“¤ê¸°</p>
    <input type="text" id="titleInput" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] placeholder-purple-800" placeholder="ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required/>
    <p class="text-purple-800 font-bold">ê°€ëŠ¥í•œ ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</p>

    <div class="dropdown-wrapper">
      <div class="custom-dropdown">
        <button id="dropdownMenu1Button" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] placeholder-purple-800">
          ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”
          <i class="fas fa-chevron-down"></i>
        </button>
        <div id="dropdownMenu1" class="dropdown-menu">
          <!-- ì‹œê°„ ì˜µì…˜ë“¤ ì¶”ê°€ -->
          <a href="#">12:00 AM</a>
          <a href="#">01:00 AM</a>
          <a href="#">02:00 AM</a>
          <a href="#">03:00 AM</a>
          <a href="#">04:00 AM</a>
          <a href="#">05:00 AM</a>
          <a href="#">06:00 AM</a>
          <a href="#">07:00 AM</a>
          <a href="#">08:00 AM</a>
          <a href="#">09:00 AM</a>
          <a href="#">10:00 AM</a>
          <a href="#">11:00 AM</a>
          <a href="#">12:00 PM</a>
          <a href="#">01:00 PM</a>
          <a href="#">02:00 PM</a>
          <a href="#">03:00 PM</a>
          <a href="#">04:00 PM</a>
          <a href="#">05:00 PM</a>
          <a href="#">06:00 PM</a>
          <a href="#">07:00 PM</a>
          <a href="#">08:00 PM</a>
          <a href="#">09:00 PM</a>
          <a href="#">10:00 PM</a>
          <a href="#">11:00 PM</a>
        </div>
      </div>
      <div class="text-between">
        <span>ë¶€í„°</span>
      </div>
      <div class="custom-dropdown">
        <button id="dropdownMenu2Button" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-900 mt-[10px] placeholder-purple-800">
          ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”
          <i class="fas fa-chevron-down"></i>
        </button>
        <div id="dropdownMenu2" class="dropdown-menu">
          <!-- ì‹œê°„ ì˜µì…˜ë“¤ ì¶”ê°€ -->
          <a href="#">12:00 AM</a>
          <a href="#">01:00 AM</a>
          <a href="#">02:00 AM</a>
          <a href="#">03:00 AM</a>
          <a href="#">04:00 AM</a>
          <a href="#">05:00 AM</a>
          <a href="#">06:00 AM</a>
          <a href="#">07:00 AM</a>
          <a href="#">08:00 AM</a>
          <a href="#">09:00 AM</a>
          <a href="#">10:00 AM</a>
          <a href="#">11:00 AM</a>
          <a href="#">12:00 PM</a>
          <a href="#">01:00 PM</a>
          <a href="#">02:00 PM</a>
          <a href="#">03:00 PM</a>
          <a href="#">04:00 PM</a>
          <a href="#">05:00 PM</a>
          <a href="#">06:00 PM</a>
          <a href="#">07:00 PM</a>
          <a href="#">08:00 PM</a>
          <a href="#">09:00 PM</a>
          <a href="#">10:00 PM</a>
          <a href="#">11:00 PM</a>
          <a href="#">00:00 AM</a>
        </div>
      </div>
    </div>
    <p class="text-purple-800 font-bold mt-[10px] mb-[10px]">ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</p>
    <div id="calendar">
      <div class="calendar-nav">
        <button id="prevBtn" aria-label="ì´ì „ ë‹¬">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <polyline points="10,3 5,8 10,13" fill="none" stroke="#4a148c" stroke-width="2"/>
          </svg>
        </button>
        <div class="calendar-header" id="calendarHeader"></div>
        <button id="nextBtn" aria-label="ë‹¤ìŒ ë‹¬">
          <svg width="16" height="16" viewBox="0 0 16 16">
            <polyline points="6,3 11,8 6,13" fill="none" stroke="#4a148c" stroke-width="2"/>
          </svg>
        </button>
      </div>
      <table id="calendarTable"></table>
      <button id="todayBtn" class="today-btn">
        <svg width="16" height="16" viewBox="0 0 16 16" style="vertical-align:middle;margin-right:5px;">
          <circle cx="8" cy="8" r="7" fill="none" stroke="#4a148c" stroke-width="2"/>
        </svg>
        ì˜¤ëŠ˜
      </button>
    </div>
    <button class="w-full py-3 bg-purple-700 text-white rounded-xl" id="nextButton" style="margin-top: 30px;">ë‹¤ìŒ</button>
  </div>

</div>


<footer class="bg-purple-800 text-white py-6">
  <div class="container mx-auto text-center">
    <p class="text-sm">&copy; Made with ğŸ’œ by í¼í”Œì½”ë“œë©ìŠ¤</p>
  </div>
</footer>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const dropdown1 = document.getElementById("dropdownMenu1");
    const dropdown1Button = document.getElementById("dropdownMenu1Button");

    const dropdown2 = document.getElementById("dropdownMenu2");
    const dropdown2Button = document.getElementById("dropdownMenu2Button");

    // ì‹œê°„ ë¬¸ìì—´("12:00 AM" ë“±)ì„ ë¶„ ë‹¨ìœ„ë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
    function convertTimeStringToMinutes(timeStr) {
      timeStr = timeStr.trim();
      // "00:00 AM"ì¸ ê²½ìš°ëŠ” ìì • ë‹¤ìŒë‚ ë¡œ ê°„ì£¼í•˜ì—¬ 1440ë¶„(24ì‹œê°„)ì„ ë¦¬í„´
      if(timeStr === "00:00 AM") {
        return 1440;
      }
      var parts = timeStr.split(' ');
      if(parts.length < 2) return 0;
      var timePart = parts[0];
      var meridiem = parts[1].toUpperCase();
      var timeParts = timePart.split(':');
      var hour = parseInt(timeParts[0], 10);
      var minute = parseInt(timeParts[1], 10);
      if (meridiem === "AM") {
        if(hour === 12 || hour === 0) {
          hour = 0;
        }
      } else if (meridiem === "PM") {
        if(hour !== 12) {
          hour += 12;
        }
      }
      return hour * 60 + minute;
    }

    // ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ì˜µì…˜ë“¤ì„ í•„í„°ë§í•˜ëŠ” í•¨ìˆ˜
    function updateDropdownFilters() {
      // ëª¨ë“  ì˜µì…˜ì„ ë¨¼ì € ë³´ì´ë„ë¡ ì´ˆê¸°í™”
      dropdown1.querySelectorAll("a").forEach(option => {
        option.style.display = "block";
      });
      dropdown2.querySelectorAll("a").forEach(option => {
        option.style.display = "block";
      });

      // ì‹œì‘ì‹œê°„ì´ ì„ íƒë˜ì–´ ìˆë‹¤ë©´, ì¢…ë£Œì‹œê°„ ë“œë¡­ë‹¤ìš´ì—ëŠ” ì‹œì‘ì‹œê°„ë³´ë‹¤ ì´í›„ì˜ ì˜µì…˜ë§Œ ë³´ì´ë„ë¡ í•„í„°ë§
      if (dropdown1Button.textContent.trim() !== "ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”") {
        let startMinutes = convertTimeStringToMinutes(dropdown1Button.textContent);
        dropdown2.querySelectorAll("a").forEach(option => {
          let optionMinutes = convertTimeStringToMinutes(option.textContent);
          if(optionMinutes <= startMinutes) {
            option.style.display = "none";
          }
        });
      }

      // ì¢…ë£Œì‹œê°„ì´ ì„ íƒë˜ì–´ ìˆë‹¤ë©´, ì‹œì‘ì‹œê°„ ë“œë¡­ë‹¤ìš´ì—ëŠ” ì¢…ë£Œì‹œê°„ë³´ë‹¤ ì´ì „ì˜ ì˜µì…˜ë§Œ ë³´ì´ë„ë¡ í•„í„°ë§
      if (dropdown2Button.textContent.trim() !== "ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”") {
        let endMinutes = convertTimeStringToMinutes(dropdown2Button.textContent);
        dropdown1.querySelectorAll("a").forEach(option => {
          let optionMinutes = convertTimeStringToMinutes(option.textContent);
          if(optionMinutes >= endMinutes) {
            option.style.display = "none";
          }
        });
      }
    }

    // ë“œë¡­ë‹¤ìš´ ì—´ê¸°/ë‹«ê¸° ì‹œ í•„í„° ì—…ë°ì´íŠ¸
    dropdown1Button.addEventListener("click", () => {
      updateDropdownFilters();
      dropdown1.classList.toggle("show");
    });

    dropdown2Button.addEventListener("click", () => {
      updateDropdownFilters();
      dropdown2.classList.toggle("show");
    });

    // ë“œë¡­ë‹¤ìš´ ë©”ë‰´ í•­ëª© í´ë¦­ ì‹œ ì„ íƒí•œ ê°’ ë°˜ì˜ ë° selected í´ë˜ìŠ¤ ì¶”ê°€ í›„ í•„í„° ì—…ë°ì´íŠ¸
    dropdown1.querySelectorAll("a").forEach((item) => {
      item.addEventListener("click", () => {
        dropdown1Button.textContent = item.textContent;
        dropdown1.classList.remove("show");

        // ê¸°ì¡´ ì„ íƒ ì‚­ì œ í›„ í˜„ì¬ í•­ëª©ì— selected í´ë˜ìŠ¤ ì¶”ê°€
        dropdown1.querySelectorAll("a").forEach((a) => a.classList.remove("selected"));
        item.classList.add("selected");

        updateDropdownFilters();
        // ë“œë¡­ë‹¤ìš´ ì„ íƒ ì‹œ ì˜¤ë¥˜ ì œê±°
        const existingStartError = document.getElementById("startDropdownError");
        if(existingStartError) existingStartError.remove();
        dropdown1Button.style.border = "";
      });
    });

    dropdown2.querySelectorAll("a").forEach((item) => {
      item.addEventListener("click", () => {
        dropdown2Button.textContent = item.textContent;
        dropdown2.classList.remove("show");

        // ê¸°ì¡´ ì„ íƒ ì‚­ì œ í›„ í˜„ì¬ í•­ëª©ì— selected í´ë˜ìŠ¤ ì¶”ê°€
        dropdown2.querySelectorAll("a").forEach((a) => a.classList.remove("selected"));
        item.classList.add("selected");

        updateDropdownFilters();
        // ë“œë¡­ë‹¤ìš´ ì„ íƒ ì‹œ ì˜¤ë¥˜ ì œê±°
        const existingEndError = document.getElementById("endDropdownError");
        if(existingEndError) existingEndError.remove();
        dropdown2Button.style.border = "";
      });
    });

    (function(){
      const calendarTable = document.getElementById("calendarTable");
      const header = document.getElementById("calendarHeader");
      const todayDate = new Date();
      let currentYear = todayDate.getFullYear();
      let currentMonth = todayDate.getMonth();

      function getSelectionKey(year, month) {
        return year + "-" + (month + 1);
      }

      function saveCurrentSelection() {
        const key = getSelectionKey(currentYear, currentMonth);
        const selections = [];
        const dayCells = calendarTable.querySelectorAll("td.day");
        dayCells.forEach(cell => {
          if(cell.classList.contains("selected")) {
            selections.push(cell.dataset.date);
          }
        });
        localStorage.setItem(key, JSON.stringify(selections));
      }

      function loadSelections(year, month) {
        const key = getSelectionKey(year, month);
        let selections = JSON.parse(localStorage.getItem(key));
        if(selections && selections.length) {
          const dayCells = calendarTable.querySelectorAll("td.day");
          dayCells.forEach(cell => {
            if(selections.indexOf(cell.dataset.date) !== -1) {
              cell.classList.add("selected");
            } else {
              cell.classList.remove("selected");
            }
          });
        }
      }

      function renderCalendar(year, month) {
        const monthNames = ["1ì›”", "2ì›”", "3ì›”", "4ì›”", "5ì›”", "6ì›”", "7ì›”", "8ì›”", "9ì›”", "10ì›”", "11ì›”", "12ì›”"];
        header.textContent = year + "ë…„ " + monthNames[month];

        calendarTable.innerHTML = "";

        const thead = document.createElement("thead");
        const headerRow = document.createElement("tr");
        const weekDays = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
        weekDays.forEach(day => {
          const th = document.createElement("th");
          th.textContent = day;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        calendarTable.appendChild(thead);

        const tbody = document.createElement("tbody");

        const firstDay = new Date(year, month, 1).getDay();
        const totalDays = new Date(year, month + 1, 0).getDate();

        let date = 1;
        for(let i = 0; i < 6; i++){
          const tr = document.createElement("tr");
          for(let j = 0; j < 7; j++){
            const td = document.createElement("td");
            if(i === 0 && j < firstDay) {
              td.className = "empty";
              td.textContent = "";
            } else if(date > totalDays) {
              td.className = "empty";
              td.textContent = "";
            } else {
              td.dataset.date = date;
              td.classList.add("day");
              const circle = document.createElement("div");
              circle.classList.add("circle");
              circle.textContent = date;
              td.appendChild(circle);
              if(year === todayDate.getFullYear() && month === todayDate.getMonth() && date === todayDate.getDate()){
                td.classList.add("today");
              }
              date++;
            }
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
        calendarTable.appendChild(tbody);

        loadSelections(year, month);
      }

      renderCalendar(currentYear, currentMonth);

      document.getElementById("prevBtn").addEventListener("click", function(){
        saveCurrentSelection();
        currentMonth--;
        if(currentMonth < 0){
          currentMonth = 11;
          currentYear--;
        }
        renderCalendar(currentYear, currentMonth);
      });

      document.getElementById("nextBtn").addEventListener("click", function(){
        saveCurrentSelection();
        currentMonth++;
        if(currentMonth > 11){
          currentMonth = 0;
          currentYear++;
        }
        renderCalendar(currentYear, currentMonth);
      });

      document.getElementById("todayBtn").addEventListener("click", function(){
        saveCurrentSelection();
        currentYear = todayDate.getFullYear();
        currentMonth = todayDate.getMonth();
        renderCalendar(currentYear, currentMonth);
      });

      let isMouseDown = false;
      let isTouchActive = false;
      let dragStartDay = null;
      let dragMode = "add";
      let initialSelected = new Map();

      function findDayCell(target) {
        if(target.classList.contains("day")) return target;
        if(target.parentElement && target.parentElement.classList.contains("day")) return target.parentElement;
        return null;
      }

      function handleDragStart(e) {
        const touch = e.type.includes('touch') ? e.touches[0] : e;
        const dayCell = findDayCell(document.elementFromPoint(touch.clientX, touch.clientY));

        if(dayCell && dayCell.classList.contains("day")){
          isMouseDown = true;
          isTouchActive = e.type.includes('touch');
          dragStartDay = parseInt(dayCell.dataset.date);
          initialSelected.clear();

          const dayCells = calendarTable.querySelectorAll("td.day");
          dayCells.forEach(cell => {
            initialSelected.set(cell, cell.classList.contains("selected"));
          });

          dragMode = dayCell.classList.contains("selected") ? "remove" : "add";
          if(dragMode === "add") {
            dayCell.classList.add("selected");
          } else {
            dayCell.classList.remove("selected");
          }
          e.preventDefault();
        }
      }

      function handleDragMove(e) {
        if(!isMouseDown) return;

        const touch = e.type.includes('touch') ? e.touches[0] : e;
        const dayCell = findDayCell(document.elementFromPoint(touch.clientX, touch.clientY));

        if(dayCell && dayCell.classList.contains("day")) {
          const currentDay = parseInt(dayCell.dataset.date);
          const minDay = Math.min(dragStartDay, currentDay);
          const maxDay = Math.max(dragStartDay, currentDay);

          const dayCells = calendarTable.querySelectorAll("td.day");
          dayCells.forEach(cell => {
            const cellDay = parseInt(cell.dataset.date);
            if(cellDay >= minDay && cellDay <= maxDay) {
              if(dragMode === "add") {
                cell.classList.add("selected");
              } else {
                cell.classList.remove("selected");
              }
            } else {
              if(initialSelected.get(cell)){
                cell.classList.add("selected");
              } else {
                cell.classList.remove("selected");
              }
            }
          });
        }
        e.preventDefault();
      }

      function handleDragEnd() {
        if(isMouseDown){
          isMouseDown = false;
          isTouchActive = false;
          dragStartDay = null;
          initialSelected.clear();
          saveCurrentSelection();
        }
      }

      calendarTable.addEventListener("mousedown", handleDragStart);
      calendarTable.addEventListener("mousemove", handleDragMove);
      document.addEventListener("mouseup", handleDragEnd);

      calendarTable.addEventListener("touchstart", handleDragStart, { passive: false });
      calendarTable.addEventListener("touchmove", handleDragMove, { passive: false });
      document.addEventListener("touchend", handleDragEnd);
      document.addEventListener("touchcancel", handleDragEnd);

      // ìº˜ë¦°ë” í´ë¦­ ì‹œ, ì„ íƒëœ ë‚ ì§œ ìˆ˜ê°€ ì˜¬ë°”ë¥´ë©´ ì˜¤ë¥˜ ì œê±°
      calendarTable.addEventListener("click", function(e) {
        const calendarDiv = document.getElementById("calendar");
        const calendarError = document.getElementById("calendarError");
        const selectedDays = calendarTable.querySelectorAll("td.day.selected");
        if(selectedDays.length > 0 && selectedDays.length <= 31) {
          calendarDiv.style.border = "";
          if(calendarError) {
            calendarError.remove();
          }
        }
      });
    })();

    // --- ê²€ì¦ ë° ê²½ê³ ë¬¸êµ¬ ì¶œë ¥ ---
    function validateForm() {
      let isValid = true;

      // ì¼ì • ì œëª© ê²€ì¦
      const titleInput = document.getElementById("titleInput");
      const existingTitleError = document.getElementById("titleError");
      if(existingTitleError) {
        existingTitleError.remove();
      }
      titleInput.style.border = "";
      if(titleInput.value.trim() === ""){
        isValid = false;
        titleInput.style.border = "2px solid #d32f2f";
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "titleError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ì¼ì • ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";
        titleInput.parentNode.insertBefore(errorMsg, titleInput.nextSibling);
      }

      // ì‹œì‘ì‹œê°„ ë“œë¡­ë‹¤ìš´ ê²€ì¦
      const startTimeButton = document.getElementById("dropdownMenu1Button");
      const existingStartError = document.getElementById("startDropdownError");
      if(existingStartError) {
        existingStartError.remove();
      }
      startTimeButton.style.border = "";
      if(startTimeButton.textContent.trim() === "ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”"){
        isValid = false;
        startTimeButton.style.border = "2px solid #d32f2f";
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "startDropdownError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ì‹œì‘ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
        startTimeButton.parentNode.insertBefore(errorMsg, startTimeButton.nextSibling);
      }

      // ì¢…ë£Œì‹œê°„ ë“œë¡­ë‹¤ìš´ ê²€ì¦
      const endTimeButton = document.getElementById("dropdownMenu2Button");
      const existingEndError = document.getElementById("endDropdownError");
      if(existingEndError) {
        existingEndError.remove();
      }
      endTimeButton.style.border = "";
      if(endTimeButton.textContent.trim() === "ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”"){
        isValid = false;
        endTimeButton.style.border = "2px solid #d32f2f";
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "endDropdownError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ì¢…ë£Œì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
        endTimeButton.parentNode.insertBefore(errorMsg, endTimeButton.nextSibling);
      }

      // ë‚ ì§œ ì„ íƒ ê²€ì¦ (ìº˜ë¦°ë”)
      const calendarDiv = document.getElementById("calendar");
      const existingCalendarError = document.getElementById("calendarError");
      if(existingCalendarError) {
        existingCalendarError.remove();
      }
      calendarDiv.style.border = "";
      const calendarTable = document.getElementById("calendarTable");
      const selectedDays = calendarTable.querySelectorAll("td.day.selected");
      if(selectedDays.length === 0){
        isValid = false;
        calendarDiv.style.border = "2px solid #d32f2f";
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "calendarError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
        calendarDiv.parentNode.insertBefore(errorMsg, calendarDiv.nextSibling);
      } else if(selectedDays.length > 31){
        isValid = false;
        calendarDiv.style.border = "2px solid #d32f2f";
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "calendarError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ì„ íƒí•œ ë‚ ì§œê°€ 31ì¼ì„ ì´ˆê³¼í•©ë‹ˆë‹¤.";
        calendarDiv.parentNode.insertBefore(errorMsg, calendarDiv.nextSibling);
      }
      return isValid;
    }

    document.getElementById("nextButton").addEventListener("click", function(e) {
      e.preventDefault();
      if (validateForm()) {
        location.href='/create-schedule';
      }
    });
  });
</script>
</body>
</html>
