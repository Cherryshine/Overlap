<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>OverLap - ë©”ì¸ ëœë”©í˜ì´ì§€</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>

  <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
  <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>
  <script src="/js/layout.js"></script>
  <style>
    .glass-effect {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 1rem; /* ë™ì¼í•œ ê³¡ë¥ ì„ ì ìš© */
    }
    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-2px); }
      100% { transform: translateY(0); }
    }
    .logo-animation {
      animation: float 2s ease-in-out infinite;
    }
    .full-screen {
      min-height: 100vh;
    }
    .chat-message {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    @keyframes expand {
      0% {
        opacity: 0;
        transform: scale(0.5);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }
    .animate-expand {
      animation: expand 0.6s ease-out;
      transform-origin: top;
    }

    /* ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ */
    .btn-animate {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.7s ease, transform 0.7s ease;
    }
    .btn-show {
      opacity: 1;
      transform: translateY(0);
    }

    /* ì „ì²´ ë ˆì´ì•„ì›ƒì„ flexë¡œ ì„¤ì •í•˜ì—¬ í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
    body, html {
      height: auto;  /* ê³ ì • ë†’ì´ ëŒ€ì‹  ìë™ìœ¼ë¡œ ì¡°ì • */
      margin: 0;
      display: flex;
      flex-direction: column;
    }

    .content {
      flex-grow: 1;
    }

    footer {
      margin-top: auto; /* í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
    }

    /* ì»¤ìŠ¤í…€ ë“œë¡­ë‹¤ìš´ */
    .custom-dropdown {
      position: relative;
      width: 100%; /* ë“œë¡­ë‹¤ìš´ ì „ì²´ê°€ ê°€ë¡œí­ì„ 100% ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      z-index: 10;
      display: none;
      background-color: #f4eeff;
      border-radius: 0;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      max-height: 300px;
      overflow-y: auto;
      border-radius: 5px;
      border: 1px solid #ddd;
    }

    .dropdown-menu.show {
      display: block;
    }

    .dropdown-menu a:active,
    .dropdown-menu a:focus {
      background-color: #8b5cf6; /* ë³´ë¼ìƒ‰ */
      color: white; /* ê¸€ì ìƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }

    /* ì„ íƒëœ í•­ëª©ì— ë³´ë¼ìƒ‰ ë°°ê²½ ì¶”ê°€ */
    .dropdown-menu a.selected {
      background-color: #8b5cf6; /* ë³´ë¼ìƒ‰ */
      color: white; /* ê¸€ì ìƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }

    .dropdown-menu a {
      display: block;
      padding: 8px 16px;
      color: #866198;
      text-decoration: none;
      cursor: pointer;
      border-bottom: 0.5px solid #b3a6b9; /* í•­ëª© ì‚¬ì´ì— êµ¬ë¶„ì„  ì¶”ê°€ */
    }

    .dropdown-menu a:last-child {
      border-bottom: none; /* ë§ˆì§€ë§‰ í•­ëª©ì€ êµ¬ë¶„ì„ ì´ ì—†ë„ë¡ ì„¤ì • */
    }

    .dropdown-menu a:hover {
      background-color: #aa8eec;
      color: white;
    }

    .dropdown-wrapper {
      display: flex;
      align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
      width: 100%;
      min-width: 280px; /* ë“œë¡­ë‹¤ìš´ì˜ ìµœì†Œ ë„ˆë¹„ */
      margin-bottom: 10px;
    }

    .dropdown-wrapper > .custom-dropdown {
      flex: 1 1 0%; /* ë“œë¡­ë‹¤ìš´ë“¤ì´ ë™ì¼í•œ í¬ê¸°ë¡œ ë¶„ë°°ë¨ */
    }

    .dropdown-wrapper > .text-between {
      display: flex;
      align-items: center;
      justify-content: center;
      width: auto; /* "ë¶€í„°" í…ìŠ¤íŠ¸ê°€ ê°€ìš´ë° ìœ„ì¹˜í•˜ë„ë¡ */
      font-size: 16px;
      color: #650094;
      margin: 0 10px; /* ì¢Œìš° ê°„ê²© ì¶”ê°€ */
    }

    /* ë“œë¡­ë‹¤ìš´ê³¼ "ë¶€í„°" í…ìŠ¤íŠ¸ ì‚¬ì´ì˜ ê°„ê²©ì„ ì¡°ì • */
    .dropdown-wrapper > .custom-dropdown:last-child {
      margin-right: 0; /* ë§ˆì§€ë§‰ ë“œë¡­ë‹¤ìš´ì€ ì˜¤ë¥¸ìª½ ì—¬ë°± ì—†ì• ê¸° */
    }

    .custom-dropdown button {
      display: flex;
      justify-content: space-between;
      align-items: center;
      white-space: nowrap; /* í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ë°©ì§€ */
      overflow: hidden; /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ ìˆ¨ê¹€ */
      text-overflow: ellipsis; /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ë¥¼ ...ìœ¼ë¡œ í‘œì‹œ */
    }

    /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ ì„¤ì • */
    body {
      background-size: 100% auto;  /* ë„ˆë¹„ 100%, ë†’ì´ëŠ” ìë™ìœ¼ë¡œ ì¡°ì • */
      background-repeat: no-repeat;
      min-height: 100%;  /* ìµœì†Œ ë†’ì´ë¥¼ 100%ë¡œ ì„¤ì • */
    }

    /*
    ìº˜ë¦°ë”
     */

    #calendar {
      width: 100%;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin-bottom: 5px !important;
      overflow: hidden;
    }

    #calendar table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 2px;
      table-layout: fixed;
    }

    #calendar thead {
      border-bottom: 2px solid #8b5cf6; /* ë³´ë¼ìƒ‰ êµ¬ë¶„ì„  ì¶”ê°€ */
    }

    #calendar th {
      padding: 8px 0;
      font-weight: 600;
      border-bottom: 2px solid #8b5cf6; /* ë³´ë¼ìƒ‰ êµ¬ë¶„ì„  ì¶”ê°€ */
      margin-bottom: 8px; /* êµ¬ë¶„ì„ ê³¼ ë‚ ì§œ ì‚¬ì´ ì—¬ë°± */
    }

    #calendar td {
      width: calc(100% / 7); /* 7ì¼ë¡œ ê· ë“± ë¶„í•  */
      position: relative;
      text-align: center;
      vertical-align: middle;
    }

    /* tdì— ì •ì‚¬ê°í˜• ë¹„ìœ¨ ìœ ì§€ */
    #calendar td::before {
      content: '';
      display: block;
      padding-top: 100%; /* 1:1 ë¹„ìœ¨ ìœ ì§€ */
    }

    #calendar td > * {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ ìˆ˜ì • */
    @media screen and (max-width: 360px) {
      #calendar {
        padding: 0.5rem;
        margin-bottom: 0.5rem;
      }

      #calendar table {
        border-spacing: 1px;
      }

      #calendar th {
        padding: 6px 0;
        border-bottom-width: 1px; /* ì‘ì€ í™”ë©´ì—ì„œëŠ” ë” ì–‡ì€ ì„  */
      }

      #calendar td {
        font-size: 0.7rem;
      }

      .calendar-nav {
        margin-bottom: 0.5rem;
        gap: 4px;
      }

      .calendar-nav button {
        padding: 4px 8px;
        font-size: 0.75rem;
      }

      .calendar-nav span {
        font-size: 0.9rem;
      }
    }

    @media screen and (min-width: 361px) and (max-width: 480px) {
      #calendar {
        padding: 0.75rem;
      }

      #calendar table {
        border-spacing: 1.5px;
      }

      #calendar th {
        padding: 7px 0;
        border-bottom-width: 1.5px; /* ì¤‘ê°„ í¬ê¸° í™”ë©´ì—ì„œëŠ” ì¤‘ê°„ ë‘ê»˜ì˜ ì„  */
      }

      #calendar td {
        font-size: 0.8rem;
      }

      .calendar-nav {
        margin-bottom: 0.75rem;
        gap: 6px;
      }

      .calendar-nav button {
        padding: 5px 10px;
        font-size: 0.85rem;
      }

      .calendar-nav span {
        font-size: 1rem;
      }
    }

    /* ìº˜ë¦°ë” ì…€ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
    #calendar td.day {
      cursor: pointer;
      transition: background-color 0.2s;
      -webkit-tap-highlight-color: transparent; /* ëª¨ë°”ì¼ í„°ì¹˜ ì‹œ ê¸°ë³¸ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
    }

    /* í˜¸ë²„ íš¨ê³¼ë¥¼ ë°ìŠ¤í¬í†±ì—ì„œë§Œ ì ìš© */
    @media (hover: hover) and (pointer: fine) {
      #calendar td.day:hover {
        background-color: #aa8eec;
        color: white;
        border-radius: 4px;
      }
    }

    /* í„°ì¹˜ ë””ë°”ì´ìŠ¤ë¥¼ ìœ„í•œ í™œì„± ìƒíƒœ ìŠ¤íƒ€ì¼ */
    #calendar td.day:active {
      background-color: #aa8eec;
      color: white;
      border-radius: 4px;
    }

    /* ì„ íƒëœ ë‚ ì§œ ìŠ¤íƒ€ì¼ */
    #calendar td.selected {
      background-color: #8b5cf6;
      color: white;
      border-radius: 4px;
    }

    /* ì˜¤ëŠ˜ ë‚ ì§œ ìŠ¤íƒ€ì¼ */
    #calendar td.today {
      border: 2px solid #8b5cf6;
      border-radius: 4px;
    }

    /* ë‹¬ë ¥ ë„¤ë¹„ê²Œì´ì…˜ */
    .calendar-nav {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin-bottom: 1rem;
      position: relative;
    }

    /* ì›” ì´ë™ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ */
    .month-nav {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* ì˜¤ëŠ˜ ë²„íŠ¼ ìœ„ì¹˜ ì¡°ì • */
    #todayBtn {
      position: relative;
      margin: 15px auto 5px; /* í•˜ë‹¨ ì—¬ë°± ì¶”ê°€ */
      background-color: #e1bee7;
      color: #4a148c;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      width: fit-content;
      z-index: 1; /* ë²„íŠ¼ì´ ë‹¤ë¥¸ ìš”ì†Œë“¤ ìœ„ì— í‘œì‹œë˜ë„ë¡ */
    }

    #todayBtn svg {
      width: 16px;
      height: 16px;
    }

    #todayBtn svg rect { /* circleì„ rectë¡œ ë³€ê²½ */
      fill: none;
      stroke: #4a148c;
      stroke-width: 2;
    }

    /* #todayBtn:hover {
      background-color: #d1aee7;
    } */

    /* ì‘ì€ í™”ë©´ì—ì„œ ì˜¤ëŠ˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    @media screen and (max-width: 360px) {
      #calendar {
        padding-bottom: 45px; /* ìº˜ë¦°ë” í•˜ë‹¨ íŒ¨ë”© ì¦ê°€ */
      }

      #todayBtn {
        margin: 10px auto 0;
        padding: 4px 8px;
        font-size: 0.8rem;
      }
    }

    @media screen and (min-width: 361px) and (max-width: 480px) {
      #calendar {
        padding-bottom: 50px; /* ìº˜ë¦°ë” í•˜ë‹¨ íŒ¨ë”© ì¦ê°€ */
      }

      #todayBtn {
        margin: 12px auto 0;
        padding: 5px 10px;
        font-size: 0.85rem;
      }
    }

    /* ì»¨í…Œì´ë„ˆ ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
    .container {
      min-width: 320px; /* ëª¨ë°”ì¼ ê¸°ê¸°ì˜ ì¼ë°˜ì ì¸ ìµœì†Œ ë„ˆë¹„ */
    }

    /* ì‘ì€ í™”ë©´ì„ ìœ„í•œ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
    @media screen and (max-width: 372px) {
      /* ë“œë¡­ë‹¤ìš´ ì»¨í…Œì´ë„ˆë¥¼ ì„¸ë¡œë¡œ ì¬ë°°ì¹˜ */
      .dropdown-wrapper {
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }
      /* ë“œë¡­ë‹¤ìš´ ë²„íŠ¼ì€ ì „ì²´ ë„ˆë¹„ë¡œ ì ìš©í•˜ê³ , margin-topì„ ë¬´ì¡°ê±´ ì œê±° */
      .dropdown-wrapper > .custom-dropdown {
        width: 100%;
        margin-top: 0 !important;
      }
      /* íŠ¹íˆ #dropdownMenu2Button ì—ëŠ” margin-top ì œê±°ë¥¼ í™•ì‹¤íˆ ì ìš© */
      #dropdownMenu2Button {
        margin-top: 0 !important;
      }
      /* 'ë¶€í„°' í…ìŠ¤íŠ¸ëŠ” í•œ ì¤„(ê°€ë¡œ)ë¡œ ìœ ì§€ */
      .dropdown-wrapper > .text-between {
        white-space: nowrap;
        margin: 10px 0;
      }
    }

    /* ì¤‘ê°„ í¬ê¸° í™”ë©´ì„ ìœ„í•œ ì¶”ê°€ ë¸Œë ˆì´í¬í¬ì¸íŠ¸ */
    @media screen and (min-width: 361px) and (max-width: 480px) {
      .content {
        padding: 0.75rem;
      }

      .glass-effect {
        padding: 1.5rem;
      }

      .dropdown-wrapper {
        min-width: 100%;
      }

      #calendar {
        padding: 1rem;
      }

      #calendar th,
      #calendar td {
        font-size: 0.875rem;
      }
    }

    /* ë“œë¡­ë‹¤ìš´ ë©”ë‰´ê°€ í™”ë©´ì„ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ ì²˜ë¦¬ */
    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      max-width: 100%;
      width: 100%;
    }

    /* ëª¨ë°”ì¼ì—ì„œ í„°ì¹˜ ì˜ì—­ ê°œì„  */
    .custom-dropdown button,
    .dropdown-menu a,
    #nextButton {
      min-height: 44px; /* iOS ê¶Œì¥ ìµœì†Œ í„°ì¹˜ ì˜ì—­ */
    }

    /* ìº˜ë¦°ë” ì…€ í„°ì¹˜ ì˜ì—­ ê°œì„  */
    #calendar td.day {
      min-width: 32px;
      min-height: 32px;
    }

    /* ì‘ì€ í™”ë©´ì—ì„œì˜ ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
    @media screen and (max-width: 480px) {
      .custom-dropdown button {
        font-size: 0.9rem; /* ê¸€ì í¬ê¸° ì¶•ì†Œ */
        padding: 8px; /* íŒ¨ë”© ì¶•ì†Œ */
      }

      .dropdown-wrapper {
        min-width: 100%;
      }
    }

    @media screen and (max-width: 360px) {
      .custom-dropdown button {
        font-size: 0.8rem; /* ë” ì‘ì€ í™”ë©´ì—ì„œëŠ” ê¸€ì í¬ê¸°ë¥¼ ë” ì¶•ì†Œ */
        padding: 6px; /* íŒ¨ë”©ì„ ë” ì¶•ì†Œ */
      }
    }

    /* ì¼ìš”ì¼ ìƒ‰ìƒ */
    #calendar th:first-child,
    #calendar td:first-child {
      color: #e53935; /* ë¹¨ê°„ìƒ‰ */
    }

    /* í† ìš”ì¼ ìƒ‰ìƒ */
    #calendar th:last-child,
    #calendar td:last-child {
      color: #1976d2; /* íŒŒë€ìƒ‰ */
    }

    /* ì„ íƒëœ ë‚ ì§œëŠ” ê¸€ììƒ‰ í°ìƒ‰ ìœ ì§€ */
    #calendar td.selected {
      background-color: #8b5cf6;
      color: white !important; /* !importantë¡œ í† /ì¼ìš”ì¼ ìƒ‰ìƒ ì˜¤ë²„ë¼ì´ë“œ */
      border-radius: 4px;
    }

    /* í˜¸ë²„ ìƒíƒœì—ì„œë„ ê¸€ììƒ‰ í°ìƒ‰ ìœ ì§€ */
    @media (hover: hover) and (pointer: fine) {
      #calendar td.day:hover {
        background-color: #aa8eec;
        color: white !important;
        border-radius: 4px;
      }
    }

    /* í„°ì¹˜ í™œì„± ìƒíƒœì—ì„œë„ ê¸€ììƒ‰ í°ìƒ‰ ìœ ì§€ */
    #calendar td.touch-active {
      background-color: #aa8eec;
      color: white !important;
      border-radius: 4px;
    }

    /* ë§í’ì„ (íˆ´í¬ ë„¤ëª¨ ì˜ì—­ */
    #dateHelpTooltip {
      --diamond-offset: 10px;  /* ë³€ìˆ˜ ê¸°ë³¸ê°’ ì •ì˜ */
      position: absolute;
      background: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      border-radius: 8px;
      font-size: 0.875rem;
      line-height: 1.5;
      margin-left: 20px;
      padding: 8px 16px;
      text-align: left;
      white-space: nowrap;
      z-index: 1000;
      top: calc(100% + 10px); /* ì•„ì´ì½˜ ì•„ë˜ 10px ê°„ê²© */
      /* transform ì œê±° â€“ ì¢Œì¸¡ ìœ„ì¹˜ëŠ” JSì—ì„œ ì§ì ‘ ì²˜ë¦¬ */
    }

    /* ë§í’ì„  ê¼­ì§“ì (ë§ˆë¦„ëª¨)
       - tooltip ë„¤ëª¨ì˜ ìš°ì¸¡ ìƒë‹¨ì— ìœ„ì¹˜í•˜ë©°, ì˜¤ë¥¸ìª½ offsetì€ CSS ë³€ìˆ˜(--diamond-offset)ë¡œ ì§€ì • */
    #dateHelpTooltip::before {
      content: '';
      position: absolute;
      top: -6px; /* íˆ´í¬ ìƒë‹¨ì—ì„œ 6px ìœ„ */
      right: var(--diamond-offset); /* CSS ë³€ìˆ˜ ì‚¬ìš© */
      transform: rotate(45deg);
      width: 12px;
      height: 12px;
      background: white;
      box-shadow: -3px -3px 5px rgba(0,0,0,0.1);
    }

    /* ì¢Œìš° í”ë“¤ë¦¼ ì• ë‹ˆë©”ì´ì…˜ ì •ì˜ */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    /* í”ë“¤ë¦¼ íš¨ê³¼ë¥¼ ì ìš©í•  í´ë˜ìŠ¤ */
    .shake-error {
      animation: shake 0.2s ease-in-out;
      animation-iteration-count: 2;
    }

    /* ë‚ ì§œ ìˆ«ì ìŠ¤íƒ€ì¼: ê¸°ë³¸ ì˜…ì€ íšŒìƒ‰ */
    .circle {
      color: inherit;
    }

    /* ì˜¤ëŠ˜ë³´ë‹¤ ì´ì „ ë‚ ì§œ (disabled ëœ ë‚ ì§œ)ì˜ ìˆ«ìë§Œ ì˜…ì€ íšŒìƒ‰ìœ¼ë¡œ í‘œê¸° */
    #calendar td.day.disabled .circle {
      color: #ccc;
    }

    /* ì˜¤ëŠ˜ ì´ì „ ë‚ ì§œ ë¹„í™œì„±í™”: í´ë¦­Â·ë“œë˜ê·¸ ë¶ˆê°€, ì‚´ì§ ë¶ˆíˆ¬ëª…í•˜ê²Œ ì²˜ë¦¬ */
    #calendar td.day.disabled {
      pointer-events: none;
      opacity: 0.6;
    }

    /* ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚  ê²½ìš°, inline ìŠ¤íƒ€ì¼ì„ overrideí•˜ì—¬ ë ˆì´ì•„ì›ƒì— ì˜í–¥ì„ ì£¼ì§€ ì•Šë„ë¡ ì²˜ë¦¬ */
    .custom-dropdown > #startDropdownError,
    .custom-dropdown > #endDropdownError {
      position: absolute !important;
      top: calc(100% + 4px) !important; /* ë²„íŠ¼ ë°”ë¡œ ì•„ë˜ì— ìœ„ì¹˜ (ì›í•˜ëŠ” ê°„ê²©: 4px) */
      left: 0;
      width: 100%;
      margin: 0 !important;
      padding: 0;
      font-size: 0.75em;
      color: #d32f2f;
      z-index: 10;
    }

    #titleError {
      margin-top: 5px !important;
    }

    /* ìŠ¬ë¼ì´ë“œ ìŠ¤íƒ€ì¼ */
    #slide1, #slide2 {
      transition: opacity 0.3s ease-in-out;
    }

    #slide1.active, #slide2.active {
      display: block;
      opacity: 1;
    }

    #slide1.hidden, #slide2.hidden {
      display: none;
      opacity: 0;
    }
  </style>
  <style>
    .glass-effect { 
      background: rgb(255, 255, 255); 
      backdrop-filter: blur(10px); 
      border: 1px solid rgba(255, 255, 255, 0.3); 
    } 
    .confetti { 
      position: fixed; 
      z-index: 1001;  /* ë†’ì€ z-index ìœ ì§€ */
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      pointer-events: none; 
    }
    .blur-overlay { 
      display: none; 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      backdrop-filter: blur(5px); 
      z-index: 60; /* ë„¤ë¹„ê²Œì´ì…˜ë°”(z-index: 50)ë³´ë‹¤ ë†’ê²Œ ì„¤ì • */
    }
  </style>
<style>
    .glass-effect { 
        background: rgba(255, 255, 255, 0.2); 
        backdrop-filter: blur(10px); 
        border: 1px solid rgba(255, 255, 255, 0.3); 
        border-radius: 1rem;
    }
    body, html {
        height: 100%;
        margin: 0;
        display: flex;
        flex-direction: column;
    }
    .content {
        flex-grow: 1;
    }
    footer {
        margin-top: auto; /* í‘¸í„°ë¥¼ í•˜ë‹¨ì— ê³ ì • */
    }

    /* íƒ€ì„ í…Œì´ë¸” css */
    .page-button {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgb(255, 255, 255);
        border-radius: 4px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ ì‚¬ê°í˜• í˜•íƒœ */
        box-shadow: 0 0 5px rgb(179, 142, 179);
        cursor: pointer;
        flex-shrink: 0;
      }

      .page-button:disabled {
        opacity: 0.5;
        cursor: default;
      }

      /* ìŠ¤í¬ë¡¤ ì˜ì—­ ë‚´ì— ìƒë‹¨ê³¼ í•˜ë‹¨ì— ê³ ì •ë  ë²„íŠ¼ */
      .page-button-prev {
          position: sticky;
          top: 8px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 10;
      }

      .page-button-next {
          position: sticky;
          bottom: 8px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 10;
      }

      /* ë°˜ì‘í˜• ì„¤ì • */
      @media (max-width: 629px) {
        .page-button {
          width: 28px;
          height: 28px;
        }
      }
      
/* ë°˜ì‘í˜• ì„¤ì • */
@media (max-width: 629px) {
.page-button {
  width: 28px;
  height: 28px;
}
}
.grid-cell {
position: relative;
overflow: hidden;
}

/* ì‹œê°„ êµ¬ë¶„ì„ ì„ ìœ„í•œ ê°€ìƒ ìš”ì†Œ */
.grid-cell::before {
content: '';
position: absolute;

left: -8px; /* ë¶€ëª¨ì˜ íŒ¨ë”©ë§Œí¼ ìŒìˆ˜ê°’ */
right: -8px; /* ë¶€ëª¨ì˜ íŒ¨ë”©ë§Œí¼ ìŒìˆ˜ê°’ */
top: 0;
height: 1px;
background-color: rgb(209, 213, 219);
z-index: 1;
}

/* ì‹œê°„ëŒ€ êµ¬ë¶„ì„ (ê²€ì€ìƒ‰ êµµì€ ì„ )ì˜ ê²½ìš° */
.grid-cell.hour-mark::before {
height: 1.2px;
background-color: rgb(157, 101, 203);
}

/* ì²« ë²ˆì§¸ í–‰ì˜ ì…€ì€ border ì œê±° */
.grid-row-first .grid-cell::before {
display: none;

}

    /* ì»¤ìŠ¤í…€ ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    .custom-checkbox {
        position: relative;
        display: inline-flex;
        align-items: center;
        cursor: pointer;
    }

    .custom-checkbox input {
        position: absolute;
        opacity: 0;
        cursor: pointer;
    }

    .checkmark {
        position: relative;
        height: 18px;          /* 15pxì—ì„œ 18pxë¡œ ì¡°ì • */
        width: 18px;           /* 15pxì—ì„œ 18pxë¡œ ì¡°ì • */
        background-color: #fff;
        border: 2px solid #9333ea;
        border-radius: 50%;
        margin-right: 8px;
    }


    .custom-checkbox input:checked ~ .checkmark {
        background-color: #9333ea;
    }

    .checkmark:after {
        content: "";
        position: absolute;
        display: none;
        left: 5px;            /* 4pxì—ì„œ 6pxë¡œ ì¡°ì • */
        top: 2px;             /* 1pxì—ì„œ 2pxë¡œ ì¡°ì • */
        width: 4px;           /* 3pxì—ì„œ 4pxë¡œ ì¡°ì • */
        height: 9px;          /* 7pxì—ì„œ 9pxë¡œ ì¡°ì • */
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
    }

    .custom-checkbox input:checked ~ .checkmark:after {
        display: block;
    }

    /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ìœ„í•œ #app ìŠ¤íƒ€ì¼ */
    #app {
        padding: 1rem;
        overflow: visible;
        transition: opacity 0.4s ease, padding 0.4s ease, margin 0.4s ease;
        opacity: 1;
        height: auto; /* ì»¨í…ì¸ ì— ë§ê²Œ ìë™ ì¡°ì ˆ */
    }

    #app.collapsed {
        height: 0;
        opacity: 0 !important;
        padding-top: 0 !important;
        padding-bottom: 0 !important;
        margin: 0 !important;
        overflow: hidden !important;
    }

    body {
        background-size: 100% auto;  /* ë„ˆë¹„ 100%, ë†’ì´ëŠ” ìë™ìœ¼ë¡œ ì¡°ì • */
        background-repeat: no-repeat;
        min-height: 100%;  /* ìµœì†Œ ë†’ì´ë¥¼ 100%ë¡œ ì„¤ì • */
    }

    body, html {
        height: auto;  /* ê³ ì • ë†’ì´ ëŒ€ì‹  ìë™ìœ¼ë¡œ ì¡°ì • */
        margin: 0;
        display: flex;
        flex-direction: column;
    }
</style>
<style>

    @keyframes float {
        0% { transform: translateY(0); }
        50% { transform: translateY(-2px); }
        100% { transform: translateY(0); }
    }
    .logo-animation {
        animation: float 2s ease-in-out infinite;
    }
    

</style>
</head>
<body class="bg-gradient-to-br from-purple-200 via-purple-300 to-purple-400">
      <!-- Confetti ìº”ë²„ìŠ¤ -->
      <canvas class="confetti"></canvas>

  <!-- Blur Overlay -->
  <div class="blur-overlay"></div>
<div th:insert="~{/navigation-bar :: nav}"></div>

<div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-[60px] pt-[84px] sm:pt-[150px] pb-[50px] min-h-[calc(100vh-80px)] max-w-4xl content">
  <!-- ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ -->
  <div id="slide1" class="active">
    <div class="glass-effect rounded-3xl p-8">
      <p class="text-purple-800 font-bold mb-[15px] text-2xl">ìƒˆ ì¼ì • ë§Œë“¤ê¸°</p>
      <input type="text" id="titleInput" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] placeholder-purple-800" placeholder="ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required/>

      <!-- ì„ íƒëœ ë‚ ì§œ í‘œì‹œ ì˜ì—­ ì¶”ê°€ -->
      <div id="selectedDatesContainer" class="mt-2 text-sm text-purple-800 hidden" style="display: none;">
        <p class="font-medium">ì„ íƒëœ ë‚ ì§œ:</p>
        <p id="selectedDates" class="mt-1"></p>
      </div>

      <!-- <p class="text-purple-800 font-bold">ê°€ëŠ¥í•œ ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</p> -->

      <div class="dropdown-wrapper">
        <div class="custom-dropdown">
          <button id="dropdownMenu1Button" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] placeholder-purple-800">
            ì‹œì‘ ì‹œê°„
            <i class="fas fa-chevron-down"></i>
          </button>
          <div id="dropdownMenu1" class="dropdown-menu">
            <!-- ì‹œê°„ ì˜µì…˜ë“¤ ì¶”ê°€ -->
            <a href="#">12:00 AM</a>
            <a href="#">01:00 AM</a>
            <a href="#">02:00 AM</a>
            <a href="#">03:00 AM</a>
            <a href="#">04:00 AM</a>
            <a href="#">05:00 AM</a>
            <a href="#">06:00 AM</a>
            <a href="#">07:00 AM</a>
            <a href="#">08:00 AM</a>
            <a href="#">09:00 AM</a>
            <a href="#">10:00 AM</a>
            <a href="#">11:00 AM</a>
            <a href="#">12:00 PM</a>
            <a href="#">01:00 PM</a>
            <a href="#">02:00 PM</a>
            <a href="#">03:00 PM</a>
            <a href="#">04:00 PM</a>
            <a href="#">05:00 PM</a>
            <a href="#">06:00 PM</a>
            <a href="#">07:00 PM</a>
            <a href="#">08:00 PM</a>
            <a href="#">09:00 PM</a>
            <a href="#">10:00 PM</a>
            <a href="#">11:00 PM</a>
          </div>
        </div>
        <div class="text-between">
          <span>ë¶€í„°</span>
        </div>
        <div class="custom-dropdown">
          <button id="dropdownMenu2Button" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] placeholder-purple-800">
            ì¢…ë£Œ ì‹œê°„
            <i class="fas fa-chevron-down"></i>
          </button>
          <div id="dropdownMenu2" class="dropdown-menu">
            <!-- ì‹œê°„ ì˜µì…˜ë“¤ ì¶”ê°€ -->
            <a href="#">12:00 AM</a>
            <a href="#">01:00 AM</a>
            <a href="#">02:00 AM</a>
            <a href="#">03:00 AM</a>
            <a href="#">04:00 AM</a>
            <a href="#">05:00 AM</a>
            <a href="#">06:00 AM</a>
            <a href="#">07:00 AM</a>
            <a href="#">08:00 AM</a>
            <a href="#">09:00 AM</a>
            <a href="#">10:00 AM</a>
            <a href="#">11:00 AM</a>
            <a href="#">12:00 PM</a>
            <a href="#">01:00 PM</a>
            <a href="#">02:00 PM</a>
            <a href="#">03:00 PM</a>
            <a href="#">04:00 PM</a>
            <a href="#">05:00 PM</a>
            <a href="#">06:00 PM</a>
            <a href="#">07:00 PM</a>
            <a href="#">08:00 PM</a>
            <a href="#">09:00 PM</a>
            <a href="#">10:00 PM</a>
            <a href="#">11:00 PM</a>
            <a href="#">00:00 AM</a>
          </div>
        </div>
      </div>
      <div class="flex items-center justify-between">
        <p class="text-purple-800 font-bold mt-[15px] mb-[10px]">ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</p>
        <div class="relative inline-block">
          <button type="button" class="text-purple-800" id="dateHelpBtn">
            <i class="fas fa-question-circle"></i>
          </button>
          <div id="dateHelpTooltip" class="hidden">
            í´ë¦­ ë˜ëŠ” ë“œë˜ê·¸í•˜ì—¬ ë‚ ì§œë¥¼ ì„ íƒí•©ë‹ˆë‹¤.<br/>
            ìµœëŒ€ 31ì¼ê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆì–´ìš”.
          </div>
        </div>
      </div>
      <div id="calendar">
        <div class="calendar-nav">
          <button id="prevBtn" aria-label="ì´ì „ ë‹¬">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <polyline points="10,3 5,8 10,13" fill="none" stroke="#4a148c" stroke-width="2"/>
            </svg>
          </button>
          <div class="calendar-header" id="calendarHeader"></div>
          <button id="nextBtn" aria-label="ë‹¤ìŒ ë‹¬">
            <svg width="16" height="16" viewBox="0 0 16 16">
              <polyline points="6,3 11,8 6,13" fill="none" stroke="#4a148c" stroke-width="2"/>
            </svg>
          </button>
        </div>
        <table id="calendarTable"></table>
        <button id="todayBtn" class="today-btn">
          <svg width="16" height="16" viewBox="0 0 16 16" style="vertical-align:middle;margin-right:5px;">
            <rect x="2" y="2" width="12" height="12" />
          </svg>
          ì˜¤ëŠ˜
        </button>
      </div>
      <button class="w-full py-3 bg-purple-700 text-white rounded-xl" id="nextButton" style="margin-top: 30px;">ë‹¤ìŒ</button>
    </div>
  </div>
  
  <!-- ë‘ ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ -->
  <div id="slide2" class="hidden">
    <div class="glass-effect rounded-3xl p-8">
      <div id="scheduleContainer">
            
        <!-- ê¸°ì¡´ ë‚´ìš© -->
        <p class="text-purple-800 mb-[15px] text-3xl"><a class="text-purple-800 mb-[15px] font-bold text-3xl">ëŒ€ë©´íšŒì˜</a> ê·¸ë£¹ ì¼ì •</p>
        <div class="text-purple-800 font-bold mb-[5px]">ê·¸ë£¹ì¥ì˜ ì´ë¦„ ì„¤ì •</div>
        <input type="text" id="userNameInput" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] placeholder-purple-800" placeholder="ë³´ì—¬ì§ˆ ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" required/>
        <div class="text-purple-800 font-bold mb-[5px] mt-[15px]">ê·¸ë£¹ì¥ì˜ ì‹œê°„ ì„ íƒ</div>
        <!-- ê·¸ë£¹ì¥ ì²´í¬ë°•ìŠ¤ ì„ íƒì‹œ ì• ë‹ˆë©”ì´ì…˜ -->
        <label class="custom-checkbox">
            <input type="checkbox" id="noTimeSelection">
            <span class="checkmark"></span>
            <span class="text-purple-800 text-sm">ê·¸ë£¹ì¥ì€ ì¼ì •ì— ì°¸ì—¬í•˜ì§€ ì•Šì•„ìš”</span>
        </label>
        <!-- íƒ€ì„ í…Œì´ë¸” -->
        <div id="app" class="max-w-5xl w-full p-4 bg-purple-50 rounded-lg shadow relative"></div>
        <!-- (1) ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë¡œë“œ -->
        <script src="/js/select_constructor_time.js"></script>

        <!-- (2) JSON ë°ì´í„° ë° ì´ˆê¸°í™” ë¡œì§ -->
        <script>

            let currentPage = 0;
            let itemsPerPage = window.innerWidth <= 629 ? 3 : 5;

            document.addEventListener("DOMContentLoaded", function () {
                updateSchedule();

                // ë°˜ì‘í˜• ë¦¬ì‚¬ì´ì§• ê°ì§€
                window.addEventListener("resize", function () {
                    const newItemsPerPage = window.innerWidth <= 629 ? 3 : 7;
                    if (newItemsPerPage !== itemsPerPage) {
                        itemsPerPage = newItemsPerPage;
                        currentPage = 0;
                        updateSchedule();
                    }
                });
            });

            // ì²´í¬ë°•ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸ (ì• ë‹ˆë©”ì´ì…˜ ì ìš©)
            document.getElementById('noTimeSelection').addEventListener('change', function() {
                const appDiv = document.getElementById('app');
                const completeButton = document.querySelector('.w-full.py-3.bg-purple-700'); // ì™„ë£Œ ë²„íŠ¼ ì„ íƒì
                
                if (this.checked) {
                    // display ëŒ€ì‹  collapse í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ ì• ë‹ˆë©”ì´ì…˜ì„ ì ìš©
                    appDiv.classList.add('collapsed');
                    if (completeButton) {
                        completeButton.style.marginTop = '15px';
                    }
                } else {
                    appDiv.classList.remove('collapsed');
                    if (completeButton) {
                        completeButton.style.marginTop = '30px';
                    }
                }
            });
        </script>

        <button class="w-full py-3 bg-purple-700 text-white rounded-xl mt-[30px]" id="triggerPopup">ì™„ë£Œ</button>
    </div>
    </div>
  </div>
</div>


<footer class="bg-purple-800 text-white py-6">
  <div class="container mx-auto text-center">
    <p class="text-sm">&copy; Made with ğŸ’œ by í¼í”Œì½”ë“œë©ìŠ¤</p>
  </div>
</footer>
    <!-- ì»¨í˜í‹° íŒì—… -->
       <!-- ì¼ì • ìƒì„± íŒì—… -->
       <div id="successMessage" class="fixed inset-0 flex items-center justify-center z-[999] hidden">
        <div class="glass-effect p-8 rounded-2xl text-center bg-white/30 backdrop-blur-xl shadow-xl border border-white/40">
          <div id="loadingState">
            <i class="fas fa-circle-notch fa-spin text-5xl text-purple-500 mb-4"></i>
            <h3 class="text-2xl font-bold text-purple-900 mb-2">ì¼ì •ì„ ì €ì¥í•˜ëŠ” ì¤‘...</h3>
            <p class="text-purple-800 mb-4">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
          </div>
          <div id="successState" class="hidden">
            <i class="fas fa-check-circle text-5xl text-green-500 mb-4"></i>
            <h3 class="text-2xl font-bold text-purple-900 mb-2">ì¼ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
            <p class="text-purple-800 mb-4">ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
          </div>
          <div id="errorState" class="hidden">
            <i class="fas fa-exclamation-circle text-5xl text-red-500 mb-4"></i>
            <h3 class="text-2xl font-bold text-purple-900 mb-2">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h3>
            <p id="errorMessage" class="text-purple-800 mb-4">ì¼ì • ìƒì„± ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
            <button id="closeErrorBtn" class="px-4 py-2 bg-purple-600 text-white rounded-lg">ë‹«ê¸°</button>
          </div>
        </div>
      </div>
        <!-- canvas-confetti ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜: "HH:MM" í˜•ì‹ì˜ ì‹œê°„ ë¬¸ìì—´ íŒŒì‹±
    function parseTimeString(str) {
      const [hh, mm] = str.split(":");
      return { hour: parseInt(hh, 10), minute: parseInt(mm, 10) };
    }
    
    // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜: ì‹œê°„ê³¼ ë¶„ì„ ì´ ë¶„ìœ¼ë¡œ ë³€í™˜
    function toTotalMinutes(h, m) {
      return h * 60 + m;
    }
    
    // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜: ì´ ë¶„ì„ "HH:MM" í˜•ì‹ ë¬¸ìì—´ë¡œ ë³€í™˜
    function formatTime24(totalMin) {
      const h = Math.floor(totalMin / 60);
      const min = totalMin % 60;
      const hh = h < 10 ? "0" + h : "" + h;
      const mm = min < 10 ? "0" + min : "" + min;
      return `${hh}:${mm}`;
    }

    // 12ì‹œê°„ í˜•ì‹ì„ 24ì‹œê°„ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    function convert12to24(time12h) {
      if (!time12h) return null;
      
      const [time, period] = time12h.split(' ');
      let [hours, minutes] = time.split(':');
      hours = parseInt(hours);
      
      // AM ì²˜ë¦¬
      if (period === 'AM') {
        if (hours === 12) {
          // 12:00 AMì€ 00:00
          hours = 0;
        }
      }
      // PM ì²˜ë¦¬
      else if (period === 'PM') {
        if (hours !== 12) {
          // 12:00 PMì€ ê·¸ëŒ€ë¡œ 12:00, ë‹¤ë¥¸ PM ì‹œê°„ì€ 12ë¥¼ ë”í•¨
          hours = hours + 12;
        }
      }
      
      // ì¢…ë£Œ ì‹œê°„ì´ 00:00ì¸ ê²½ìš° 24:00ìœ¼ë¡œ ë³€í™˜
      const isEndTime = document.getElementById('dropdownMenu2Button').textContent.includes(time12h);
      if (isEndTime && hours === 0 && minutes === '00') {
        hours = 24;
      }
      
      return `${hours.toString().padStart(2, '0')}:${minutes}`;
    }

    document.getElementById('triggerPopup').addEventListener('click', function() {
      // Blur Overlay ë³´ì´ê¸°
      document.querySelector('.blur-overlay').style.display = 'flex';
      
      // ì¼ì • ìƒì„± íŒì—… ë³´ì´ê¸° (ë¡œë”© ìƒíƒœë¡œ ì‹œì‘)
      const successMessage = document.getElementById('successMessage');
      const loadingState = document.getElementById('loadingState');
      const successState = document.getElementById('successState');
      const errorState = document.getElementById('errorState');
      
      successMessage.style.display = 'flex';
      loadingState.style.display = 'block';
      successState.style.display = 'none';
      errorState.style.display = 'none';
      
      // ì¼ì • ì •ë³´ ìˆ˜ì§‘
      const title = document.querySelector("#slide2 .text-3xl a").textContent; // ì¼ì • ì œëª©

      // ë‹‰ë„¤ì„ ì •ë³´ ìˆ˜ì§‘

      const username = document.getElementById("userNameInput").value;
      // ë‚ ì§œ ì •ë³´ ìˆ˜ì§‘
      let scheduleData = {
        title: title,
        username : username,
        dates: [] // ì„ íƒëœ ë‚ ì§œë“¤
      };
      
      // jsonDataì—ì„œ ë‚ ì§œ ì •ë³´ ì¶”ì¶œ
      if(window.jsonData && window.jsonData.days) {
        // ë‚ ì§œ í˜•ì‹: "Feb 9" -> "2024-02-09" í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        const currentYear = new Date().getFullYear();
        const months = {
          'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04', 'May': '05', 'Jun': '06',
          'Jul': '07', 'Aug': '08', 'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12'
        };
        
        window.jsonData.days.forEach(day => {
          const [month, dayNum] = day.date.split(' ');
          const formattedDate = `${currentYear}-${months[month]}-${dayNum.padStart(2, '0')}`;
          scheduleData.dates.push(formattedDate);
        });
      }
      
      // ì‹œì‘ ë° ì¢…ë£Œ ì‹œê°„ ì¶”ì¶œ
      if(window.jsonData) {
        const endTimeButton = document.getElementById('dropdownMenu2Button');
        const endTime12h = endTimeButton.textContent.trim();
        
        scheduleData.startTime = window.jsonData.startTime;
        // ì¢…ë£Œ ì‹œê°„ì´ 00:00(12:00 AM)ì¸ ê²½ìš° 24:00ìœ¼ë¡œ ì„¤ì •
        if (endTime12h.includes('12:00 AM')) {
          scheduleData.endTime = '24:00';
        } else {
          scheduleData.endTime = window.jsonData.endTime;
        }
      }
      
      // ê·¸ë£¹ì¥ ì°¸ì—¬ ì—¬ë¶€ ì²´í¬ (ì²´í¬ë°•ìŠ¤ê°€ í•´ì œëœ ê²½ìš° = ê·¸ë£¹ì¥ì´ ì°¸ì—¬í•¨)
      const noTimeSelection = document.getElementById('noTimeSelection');
      scheduleData.creatorParticipates = !noTimeSelection.checked;
      
      // ê·¸ë£¹ì¥ì´ ì°¸ì—¬í•˜ëŠ” ê²½ìš° ì„ íƒí•œ ì‹œê°„ ì¶”ê°€
      if(scheduleData.creatorParticipates && window.selectedCells) {
        // selectedCells ê°ì²´ì—ì„œ ì‹œê°„ ì •ë³´ ì¶”ì¶œ
        scheduleData.creatorSelectedTimes = [];
        
        // window.jsonData.daysì™€ selectedCellsë¥¼ ë§¤í•‘í•˜ì—¬ ì„ íƒëœ ì‹œê°„ ëª©ë¡ ìƒì„±
        for(const cellKey in window.selectedCells) {
          if(window.selectedCells[cellKey]) {
            const [startIndex, date, timeIndex] = cellKey.split('-');
            const startTimeObj = parseTimeString(window.jsonData.startTime);
            const startTotalMin = toTotalMinutes(startTimeObj.hour, startTimeObj.minute);
            const blockStartMin = startTotalMin + parseInt(timeIndex) * window.jsonData.interval;
            const blockEndMin = blockStartMin + window.jsonData.interval;
            
            // startIndexë¥¼ ì‚¬ìš©í•˜ì—¬ ì›ë˜ ë‚ ì§œ ì¸ë±ìŠ¤ ê³„ì‚°
            const actualIndex = parseInt(startIndex) * itemsPerPage + 
                               window.jsonData.days.findIndex(d => d.date === date);
            
            if(actualIndex >= 0 && actualIndex < window.jsonData.days.length) {
              const currentYear = new Date().getFullYear();
              const [month, dayNum] = window.jsonData.days[actualIndex].date.split(' ');
              const months = {
                'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04', 'May': '05', 'Jun': '06',
                'Jul': '07', 'Aug': '08', 'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12'
              };
              const formattedDate = `${currentYear}-${months[month]}-${dayNum.padStart(2, '0')}`;
              
              scheduleData.creatorSelectedTimes.push({
                date: formattedDate,
                startTime: formatTime24(blockStartMin),
                endTime: formatTime24(blockEndMin)
              });
            }
          }
        }
      }
      
      // scheduleDataë¥¼ ì½˜ì†”ì— ì¶œë ¥í•˜ì—¬ í™•ì¸
      console.log('ì „ì†¡í•  ë°ì´í„°:', scheduleData);
      
      // fetch ìš”ì²­ ìˆ˜ì •
      fetch('/api/schedules', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        credentials: 'same-origin', // ì¿ í‚¤ í¬í•¨
        body: JSON.stringify(scheduleData)
      })
      .then(response => {
        console.log(response);
        if (!response.redirected) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        // ì„±ê³µ ìƒíƒœë¡œ íŒì—… ì—…ë°ì´íŠ¸
        loadingState.style.display = 'none';
        successState.style.display = 'block';

        // ì„±ê³µ ì‹œì—ë§Œ ì»¨í˜í‹° íš¨ê³¼ ì‹¤í–‰
        confetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 }
        });
        
        // 2ì´ˆ í›„ì— ë¦¬ë‹¤ì´ë ‰íŠ¸
        setTimeout(() => {
          window.location.href = response.url;
        }, 1500);
      })
      .catch(error => {
        console.error('ì¼ì • ìƒì„± ì˜¤ë¥˜:', error);
        
        // ì˜¤ë¥˜ ìƒíƒœë¡œ íŒì—… ì—…ë°ì´íŠ¸
        loadingState.style.display = 'none';
        errorState.style.display = 'block';
        
        // ì˜¤ë¥˜ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        document.getElementById('errorMessage').textContent = error.message || 'ì¼ì • ìƒì„± ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      });
    });
    
    // ì˜¤ë¥˜ íŒì—… ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    document.getElementById('closeErrorBtn').addEventListener('click', function() {
      document.getElementById('successMessage').style.display = 'none';
      document.querySelector('.blur-overlay').style.display = 'none';
    });
  </script>

<script>
  let selectedDatesMap = new Map(); // ì„ íƒëœ ë‚ ì§œë¥¼ ì €ì¥í•  ì „ì—­ ë³€ìˆ˜

  document.addEventListener('DOMContentLoaded', function () {
    const dropdown1 = document.getElementById("dropdownMenu1");
    const dropdown1Button = document.getElementById("dropdownMenu1Button");

    const dropdown2 = document.getElementById("dropdownMenu2");
    const dropdown2Button = document.getElementById("dropdownMenu2Button");

    // ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ì˜µì…˜ë“¤ì„ í•„í„°ë§í•˜ëŠ” í•¨ìˆ˜ - ëª¨ë“  ì˜µì…˜ì´ ë³´ì´ë„ë¡ ì—…ë°ì´íŠ¸
    function updateDropdownFilters() {
      // ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ ë“œë¡­ë‹¤ìš´ì˜ ëª¨ë“  ì˜µì…˜ì„ í•­ìƒ ë³´ì´ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.
      dropdown1.querySelectorAll("a").forEach(option => {
        option.style.display = "block";
      });
      dropdown2.querySelectorAll("a").forEach(option => {
        option.style.display = "block";
      });
    }

    // ë“œë¡­ë‹¤ìš´ ì—´ê¸°/ë‹«ê¸° ì‹œ í•„í„° ì—…ë°ì´íŠ¸
    dropdown1Button.addEventListener("click", () => {
      updateDropdownFilters();
      dropdown1.classList.toggle("show");
    });

    dropdown2Button.addEventListener("click", () => {
      updateDropdownFilters();
      dropdown2.classList.toggle("show");
    });

    // ë“œë¡­ë‹¤ìš´ ë©”ë‰´ í•­ëª© í´ë¦­ ì‹œ ì„ íƒí•œ ê°’ ë°˜ì˜ ë° selected í´ë˜ìŠ¤ ì¶”ê°€ í›„ í•„í„° ì—…ë°ì´íŠ¸
    dropdown1.querySelectorAll("a").forEach((item) => {
      item.addEventListener("click", () => {
        dropdown1Button.textContent = item.textContent;
        dropdown1.classList.remove("show");

        // ê¸°ì¡´ ì„ íƒ ì‚­ì œ í›„ í˜„ì¬ í•­ëª©ì— selected í´ë˜ìŠ¤ ì¶”ê°€
        dropdown1.querySelectorAll("a").forEach((a) => a.classList.remove("selected"));
        item.classList.add("selected");

        updateDropdownFilters();
        // ë“œë¡­ë‹¤ìš´ ì„ íƒ ì‹œ ì˜¤ë¥˜ ì œê±°
        const existingStartError = document.getElementById("startDropdownError");
        if(existingStartError) existingStartError.remove();
        dropdown1Button.style.border = "";
      });
    });

    dropdown2.querySelectorAll("a").forEach((item) => {
      item.addEventListener("click", () => {
        dropdown2Button.textContent = item.textContent;
        dropdown2.classList.remove("show");

        // ê¸°ì¡´ ì„ íƒ ì‚­ì œ í›„ í˜„ì¬ í•­ëª©ì— selected í´ë˜ìŠ¤ ì¶”ê°€
        dropdown2.querySelectorAll("a").forEach((a) => a.classList.remove("selected"));
        item.classList.add("selected");

        updateDropdownFilters();
        // ë“œë¡­ë‹¤ìš´ ì„ íƒ ì‹œ ì˜¤ë¥˜ ì œê±°
        const existingEndError = document.getElementById("endDropdownError");
        if(existingEndError) existingEndError.remove();
        dropdown2Button.style.border = "";
      });
    });

    (function(){
      const calendarTable = document.getElementById("calendarTable");
      const header = document.getElementById("calendarHeader");
      const todayDate = new Date();
      let currentYear = todayDate.getFullYear();
      let currentMonth = todayDate.getMonth();

      function getSelectionKey(year, month) {
        return `${year}-${month + 1}`;
      }

      function saveCurrentSelection() {
        const key = getSelectionKey(currentYear, currentMonth);
        const selections = [];
        const dayCells = calendarTable.querySelectorAll("td.day");
        dayCells.forEach(cell => {
          if(cell.classList.contains("selected")) {
            selections.push(cell.dataset.date);
          }
        });
        selectedDatesMap.set(key, selections);
      }

      function loadSelections(year, month) {
        const key = getSelectionKey(year, month);
        let selections = selectedDatesMap.get(key);
        const todayDate = new Date();
        const today = todayDate.getDate();
        const currentMonth = todayDate.getMonth();
        const currentYear = todayDate.getFullYear();

        if (selections && selections.length) {
            const dayCells = calendarTable.querySelectorAll("td.day");
            dayCells.forEach(cell => {
                const cellDate = parseInt(cell.dataset.date);
                const cellMonth = month;
                const cellYear = year;

                if (cellYear < todayDate.getFullYear() || 
                    (cellYear === todayDate.getFullYear() && cellMonth < todayDate.getMonth()) || 
                    (cellYear === todayDate.getFullYear() && cellMonth === todayDate.getMonth() && cellDate < today)) {
                    cell.classList.add("disabled");
                    cell.classList.remove("selected");
                } else if (selections.indexOf(cell.dataset.date) !== -1) {
                    cell.classList.add("selected");
                } else {
                    cell.classList.remove("selected");
                }
            });
        }
      }

      function renderCalendar(year, month) {
        const monthNames = ["1ì›”", "2ì›”", "3ì›”", "4ì›”", "5ì›”", "6ì›”", "7ì›”", "8ì›”", "9ì›”", "10ì›”", "11ì›”", "12ì›”"];
        header.textContent = year + "ë…„ " + monthNames[month];
        calendarTable.innerHTML = "";

        const thead = document.createElement("thead");
        const headerRow = document.createElement("tr");
        const weekDays = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
        weekDays.forEach(day => {
          const th = document.createElement("th");
          th.textContent = day;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        calendarTable.appendChild(thead);

        const tbody = document.createElement("tbody");
        const firstDay = new Date(year, month, 1).getDay();
        const totalDays = new Date(year, month + 1, 0).getDate();
        let date = 1;
        for (let i = 0; i < 6; i++) {
          const tr = document.createElement("tr");
          for (let j = 0; j < 7; j++) {
            const td = document.createElement("td");
            if (i === 0 && j < firstDay) {
              td.className = "empty";
              td.textContent = "";
            } else if (date > totalDays) {
              td.className = "empty";
              td.textContent = "";
            } else {
              td.dataset.date = date;
              td.classList.add("day");
              // ì˜¤ëŠ˜ ë‚ ì§œë³´ë‹¤ ì´ì „ì´ë©´ disabled í´ë˜ìŠ¤ ì¶”ê°€
              if (
                      year < todayDate.getFullYear() ||
                      (year === todayDate.getFullYear() && month < todayDate.getMonth()) ||
                      (year === todayDate.getFullYear() && month === todayDate.getMonth() && date < todayDate.getDate())
              ) {
                td.classList.add("disabled");
              }
              const circle = document.createElement("div");
              circle.classList.add("circle");
              circle.textContent = date;
              td.appendChild(circle);
              if (year === todayDate.getFullYear() && month === todayDate.getMonth() && date === todayDate.getDate()) {
                td.classList.add("today");
              }
              date++;
            }
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
        calendarTable.appendChild(tbody);

        loadSelections(year, month);
        updateSelectedDates();
      }

      renderCalendar(currentYear, currentMonth);

      document.getElementById("prevBtn").addEventListener("click", function(){
        saveCurrentSelection();
        currentMonth--;
        if(currentMonth < 0){
          currentMonth = 11;
          currentYear--;
        }
        renderCalendar(currentYear, currentMonth);
      });

      document.getElementById("nextBtn").addEventListener("click", function(){
        saveCurrentSelection();
        currentMonth++;
        if(currentMonth > 11){
          currentMonth = 0;
          currentYear++;
        }
        renderCalendar(currentYear, currentMonth);
      });

      document.getElementById("todayBtn").addEventListener("click", function(){
        saveCurrentSelection();
        currentYear = todayDate.getFullYear();
        currentMonth = todayDate.getMonth();
        renderCalendar(currentYear, currentMonth);
      });

      let isMouseDown = false;
      let isTouchActive = false;
      let dragStartDay = null;
      let dragMode = "add";
      let initialSelected = new Map();

      function findDayCell(target) {
        if(target.classList.contains("day")) return target;
        if(target.parentElement && target.parentElement.classList.contains("day")) return target.parentElement;
        return null;
      }

      function getTotalSelectedAcrossAllPages() {
        let total = 0;
        // Mapì„ ì˜¬ë°”ë¥´ê²Œ ìˆœíšŒí•˜ê¸° ìœ„í•´ for...of êµ¬ë¬¸ ì‚¬ìš©
        for (const selections of selectedDatesMap.values()) {
          total += selections.length;
        }
        return total;
      }

      let calendarErrorTimeoutId; // ë‹¬ë ¥ ì—ëŸ¬ íƒ€ì´ë¨¸ë¥¼ ì €ì¥í•  ë³€ìˆ˜

      function showCalendarSelectionError() {
        const calendarDiv = document.getElementById("calendar");

        if (calendarErrorTimeoutId) {
          clearTimeout(calendarErrorTimeoutId);
          calendarErrorTimeoutId = null;
        }

        isCalendarErrorActive = true; // âœ… ì—ëŸ¬ ìƒíƒœ í™œì„±í™”

        let existingError = document.getElementById("calendarSelectionError");
        if (existingError) existingError.remove();

        calendarDiv.style.border = "2px solid #d32f2f";

        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "calendarSelectionError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.marginTop = "4px";
        errorMsg.style.zIndex = "10";
        errorMsg.textContent = "ìµœëŒ€ 31ì¼ê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";

        calendarDiv.parentNode.insertBefore(errorMsg, calendarDiv.nextSibling);

        calendarDiv.classList.add("shake-error");
        setTimeout(() => {
          calendarDiv.classList.remove("shake-error");
        }, 400);

        calendarErrorTimeoutId = setTimeout(() => {
          calendarDiv.style.border = "";
          const errorMsg = document.getElementById("calendarSelectionError");
          if (errorMsg) errorMsg.remove();
          isCalendarErrorActive = false; // âœ… ì—ëŸ¬ ìƒíƒœ ì¢…ë£Œ
          calendarErrorTimeoutId = null;
        }, 2000);
      }

      function handleDragStart(e) {
        const touch = e.type.includes('touch') ? e.touches[0] : e;
        const dayCell = findDayCell(document.elementFromPoint(touch.clientX, touch.clientY));
        if (dayCell && dayCell.classList.contains("disabled")) return;
        if (dayCell && dayCell.classList.contains("day")) {
          isMouseDown = true;
          isTouchActive = e.type.includes('touch');
          dragStartDay = parseInt(dayCell.dataset.date);
          initialSelected.clear();
          const dayCells = Array.from(calendarTable.querySelectorAll("td.day"));
          dayCells.forEach(cell => {
            initialSelected.set(cell, cell.classList.contains("selected"));
          });
          dragMode = dayCell.classList.contains("selected") ? "remove" : "add";

          if (dragMode === "add") {
            const currentMonthKey = getSelectionKey(currentYear, currentMonth);
            const currentMonthSaved = selectedDatesMap.get(currentMonthKey) || [];
            const currentMonthSavedCount = currentMonthSaved.length;
            let currentPageCount = 0;
            dayCells.forEach(cell => {
              if (cell.classList.contains("selected")) currentPageCount++;
            });
            const totalStored = getTotalSelectedAcrossAllPages();
            const otherPagesCount = totalStored - currentMonthSavedCount;
            const overallSelectedCount = otherPagesCount + currentPageCount;
            if (overallSelectedCount >= 31) {
              showCalendarSelectionError();
              isMouseDown = false;
              return;
            }
            dayCell.classList.add("selected");
          } else {
            dayCell.classList.remove("selected");
          }
          removeCalendarError();
          e.preventDefault();
        }
      }

      function handleDragMove(e) {
        if (!isMouseDown) return;
        const touch = e.type.includes('touch') ? e.touches[0] : e;
        const dayCell = findDayCell(document.elementFromPoint(touch.clientX, touch.clientY));
        if (dayCell && dayCell.classList.contains("day")) {
          if (dayCell.classList.contains("disabled")) return;
          const currentDay = parseInt(dayCell.dataset.date);
          const minDay = Math.min(dragStartDay, currentDay);
          const maxDay = Math.max(dragStartDay, currentDay);
          const allDayCells = Array.from(calendarTable.querySelectorAll("td.day"));

          const currentMonthKey = getSelectionKey(currentYear, currentMonth);
          const currentMonthSaved = selectedDatesMap.get(currentMonthKey) || [];
          const currentMonthSavedCount = currentMonthSaved.length;
          let currentPageCount = 0;
          allDayCells.forEach(cell => {
            if (cell.classList.contains("selected")) currentPageCount++;
          });
          const totalStored = getTotalSelectedAcrossAllPages();
          const otherPagesCount = totalStored - currentMonthSavedCount;
          let overallSelectedCount = otherPagesCount + currentPageCount;

          allDayCells.forEach(cell => {
            if (cell.classList.contains("disabled")) return;
            const cellDay = parseInt(cell.dataset.date);
            if (cellDay >= minDay && cellDay <= maxDay) {
              if (dragMode === "add") {
                if (!cell.classList.contains("selected")) {
                  if (overallSelectedCount < 31) {
                    cell.classList.add("selected");
                    overallSelectedCount++;
                  } else {
                    showCalendarSelectionError();
                    cell.classList.remove("selected");
                  }
                }
              } else {
                if (cell.classList.contains("selected")) {
                  cell.classList.remove("selected");
                  overallSelectedCount = Math.max(0, overallSelectedCount - 1);
                }
              }
            } else {
              if (initialSelected.get(cell)) {
                cell.classList.add("selected");
              } else {
                cell.classList.remove("selected");
              }
            }
          });
        }
        e.preventDefault();
      }

      function handleDragEnd(e) {
        if(isMouseDown){
          isMouseDown = false;
          isTouchActive = false;
          dragStartDay = null;
          initialSelected.clear();
          saveCurrentSelection();
          removeCalendarError();
          updateSelectedDates();
        }
      }
      let isCalendarErrorActive = false;  // ì „ì—­ìœ¼ë¡œ ì„ ì–¸!

      // ìˆ˜ì •ëœ removeCalendarError í•¨ìˆ˜
      function removeCalendarError() {
        // âœ… ì—ëŸ¬ê°€ í™œì„±í™”ëœ ë™ì•ˆì€ ì¡°ê¸° ì‚­ì œ ê¸ˆì§€
        if (isCalendarErrorActive) {
          return;
        }

        const calendarDiv = document.getElementById("calendar");
        const calendarError = document.getElementById("calendarError");
        const selectionError = document.getElementById("calendarSelectionError");
        const selectedDays = document.querySelectorAll("td.day.selected");

        if (selectedDays.length > 0 && selectedDays.length <= 31) {
          calendarDiv.style.border = "";
          if (calendarError) {
            calendarError.remove();
          }
          if (selectionError) {
            selectionError.remove();
          }
        }
      }

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (ì¤‘ë³µ ì œê±°)
      calendarTable.addEventListener("mousedown", handleDragStart);
      calendarTable.addEventListener("mousemove", handleDragMove);
      document.addEventListener("mouseup", handleDragEnd);

      calendarTable.addEventListener("touchstart", handleDragStart, { passive: false });
      calendarTable.addEventListener("touchmove", handleDragMove, { passive: false });
      document.addEventListener("touchend", handleDragEnd);
      document.addEventListener("touchcancel", handleDragEnd);

      // í´ë¦­ ì´ë²¤íŠ¸ëŠ” ë³„ë„ë¡œ ìœ ì§€ (ë“œë˜ê·¸ì™€ ê´€ê³„ì—†ì´ ë‹¨ì¼ í´ë¦­ ì²˜ë¦¬)
      calendarTable.addEventListener("click", function(e) {
        removeCalendarError();
        updateSelectedDates();
      });

      // ìˆ˜ì •ëœ updateSelectedDates í•¨ìˆ˜: localStorageì— ì €ì¥ëœ ëª¨ë“  ì„ íƒ ë‚ ì§œë¥¼ ë¶ˆëŸ¬ì™€ ì •ë ¬ ë° í‘œì‹œ
      function updateSelectedDates() {
        const selectedDatesContainer = document.getElementById('selectedDatesContainer');
        const selectedDatesElement = document.getElementById('selectedDates');

        let allDates = [];
        // localStorageì˜ ëª¨ë“  í‚¤ë¥¼ ìˆœíšŒí•˜ë©´ì„œ "dateSelection_" ì ‘ë‘ì–´ê°€ ìˆëŠ” í•­ëª©ë§Œ ì²˜ë¦¬
        for (let i = 0; i < selectedDatesMap.size; i++) {
          const key = selectedDatesMap.keys().next().value;
          const days = selectedDatesMap.get(key);
          days.forEach(day => {
            allDates.push({ year: parseInt(key.split('-')[0]), month: parseInt(key.split('-')[1]), day: parseInt(day) });
          });
        }

        if (allDates.length > 0) {
          // ë‚ ì§œ ìˆœì„œëŒ€ë¡œ ì •ë ¬ (ì—°Â·ì›”Â·ì¼)
          allDates.sort((a, b) => {
            if (a.year !== b.year) return a.year - b.year;
            if (a.month !== b.month) return a.month - b.month;
            return a.day - b.day;
          });

          // ì—°ì†ëœ ë‚ ì§œë¥¼ ê·¸ë£¹í™”í•˜ëŠ” í•¨ìˆ˜
          function groupConsecutiveDates(dates) {
            const groups = [];
            let currentGroup = [dates[0]];
            for (let i = 1; i < dates.length; i++) {
              const prev = dates[i - 1];
              const curr = dates[i];
              // Date ê°ì²´ë¡œ ë³€í™˜ í›„ ì¼ìˆ˜ ì°¨ì´ ê³„ì‚° (ì—°ì†ì ì´ë©´ diff === 1)
              const prevDate = new Date(prev.year, prev.month - 1, prev.day);
              const currDate = new Date(curr.year, curr.month - 1, curr.day);
              const diff = (currDate - prevDate) / (1000 * 60 * 60 * 24);
              if (diff === 1) {
                currentGroup.push(curr);
              } else {
                groups.push(currentGroup);
                currentGroup = [curr];
              }
            }
            groups.push(currentGroup);
            return groups;
          }

          const groups = groupConsecutiveDates(allDates);

          // ê° ê·¸ë£¹ë³„ ì¶œë ¥ í˜•ì‹ ê²°ì •: ì—°ì†ì´ë©´ "ì²«ë‚  ~ ë§ˆì§€ë§‰ë‚ ", ì•„ë‹ˆë©´ ê°œë³„ ë‚ ì§œ
          const dateStrings = groups.map(group => {
            if (group.length > 1) {
              const first = group[0];
              const last = group[group.length - 1];
              return `${first.year}ë…„ ${first.month}ì›” ${first.day}ì¼ ~ ${last.year}ë…„ ${last.month}ì›” ${last.day}ì¼`;
            } else {
              const d = group[0];
              return `${d.year}ë…„ ${d.month}ì›” ${d.day}ì¼`;
            }
          });

          // ê¸°ë³¸ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ (ì½¤ë§ˆë¡œ êµ¬ë¶„)
          selectedDatesElement.textContent = dateStrings.join(', ');
          selectedDatesContainer.classList.remove('hidden');
        } else {
          selectedDatesContainer.classList.add('hidden');
        }
      }
    })();

    // --- ê²€ì¦ ë° ê²½ê³ ë¬¸êµ¬ ì¶œë ¥ ---
    function parseTime(timeStr) {
      // ë§Œì•½ "00:00 AM"ì´ë©´ ë‹¤ìŒ ë‚ ì˜ ìì •(24:00)ì„ ì˜ë¯¸í•˜ë„ë¡ 1440 ë°˜í™˜
      if (timeStr.trim() === "00:00 AM") {
        return 24 * 60;
      }
      const parts = timeStr.split(' ');
      if (parts.length < 2) return NaN;
      const timePart = parts[0];
      const period = parts[1].toUpperCase();
      let [hour, minute] = timePart.split(':').map(Number);
      if (period === "AM" && hour === 12) {
        hour = 0;
      } else if (period === "PM" && hour < 12) {
        hour += 12;
      }
      return hour * 60 + minute;
    }

//////////////////////////////////////////////////////////
    let isSubmitting = false; // ì¤‘ë³µ ìš”ì²­ ë°©ì§€

// âœ… ê¸°ì¡´ ë°ì´í„°ì™€ í˜„ì¬ ë°ì´í„° ë¹„êµ (ì œëª©, ì‹œê°„, ë‚ ì§œ ë³€ê²½ ì‹œ ì—…ë°ì´íŠ¸)
    function isSameData(newData) {
      const storedData = localStorage.getItem("lastSavedData");
      if (!storedData) return false;
      return JSON.stringify(newData) === storedData;
    }

    document.getElementById("nextButton").addEventListener("click", function(e) {
      e.preventDefault();
      if (validateForm()) {
        // ì…ë ¥ëœ ë°ì´í„° ìˆ˜ì§‘
        const title = document.getElementById("titleInput").value;
        const startTime = document.getElementById("dropdownMenu1Button").textContent.trim();
        const endTime = document.getElementById("dropdownMenu2Button").textContent.trim();
        
        // ì„ íƒëœ ë‚ ì§œë“¤ ìˆ˜ì§‘
        let selectedDates = [];
        selectedDatesMap.forEach((days, yearMonth) => {
          const [year, month] = yearMonth.split("-").map(Number);
          days.forEach(day => {
            selectedDates.push({
              year: year,
              month: month - 1,
              day: parseInt(day)
            });
          });
        });

        // ë‚ ì§œ ì •ë ¬
        selectedDates.sort((a, b) => {
          const dateA = new Date(a.year, a.month, a.day);
          const dateB = new Date(b.year, b.month, b.day);
          return dateA - dateB;
        });

        // íƒ€ì„í…Œì´ë¸” ë°ì´í„° ìƒì„±
        const jsonData = {
          startTime: convert12to24(startTime),
          endTime: convert12to24(endTime),
          interval: 15,
          days: selectedDates.map(date => {
            const d = new Date(date.year, date.month, date.day);
            const weekdays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
            const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            return {
              label: weekdays[d.getDay()],
              date: `${months[d.getMonth()]} ${d.getDate()}`
            };
          })
        };

        // ì¼ì • ì œëª© ì—…ë°ì´íŠ¸
        const scheduleTitle = document.querySelector("#slide2 .text-3xl a");
        scheduleTitle.textContent = title;

        // ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ ìˆ¨ê¸°ê¸°
        document.getElementById("slide1").classList.remove("active");
        document.getElementById("slide1").classList.add("hidden");
        
        // ë‘ ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ ë³´ì´ê¸°
        document.getElementById("slide2").classList.remove("hidden");
        document.getElementById("slide2").classList.add("active");
        
        // íƒ€ì„í…Œì´ë¸” ì´ˆê¸°í™” ë° ì—…ë°ì´íŠ¸
        window.jsonData = jsonData;
        window.updateSchedule();
        
        // ìŠ¤í¬ë¡¤ì„ ë§¨ ìœ„ë¡œ
        window.scrollTo(0, 0);
      }
    });




    function validateForm() {
      let isValid = true;
      let firstErrorElement = null;

      // ì¼ì • ì œëª© ê²€ì¦
      const titleInput = document.getElementById("titleInput");
      const existingTitleError = document.getElementById("titleError");
      if(existingTitleError) {
        existingTitleError.remove();
      }
      titleInput.style.border = "";
      if(titleInput.value.trim() === ""){
        isValid = false;
        titleInput.style.border = "2px solid #d32f2f";
        titleInput.classList.add("shake-error");
        setTimeout(() => titleInput.classList.remove("shake-error"), 400);
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "titleError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ì¼ì • ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";
        titleInput.parentNode.insertBefore(errorMsg, titleInput.nextSibling);
        if (!firstErrorElement) firstErrorElement = titleInput;
      }

      // ì‹œì‘ì‹œê°„ ë“œë¡­ë‹¤ìš´ ê²€ì¦
      const startTimeButton = document.getElementById("dropdownMenu1Button");
      const existingStartError = document.getElementById("startDropdownError");
      if(existingStartError) {
        existingStartError.remove();
      }
      startTimeButton.style.border = "";
      if(startTimeButton.textContent.trim() === "ì‹œì‘ ì‹œê°„"){
        isValid = false;
        startTimeButton.style.border = "2px solid #d32f2f";
        startTimeButton.classList.add("shake-error");
        setTimeout(() => startTimeButton.classList.remove("shake-error"), 400);
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "startDropdownError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.whiteSpace = "nowrap";
        errorMsg.textContent = "ì‹œì‘ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
        startTimeButton.parentNode.style.overflow = "visible";
        startTimeButton.parentNode.insertBefore(errorMsg, startTimeButton.nextSibling);
        if (!firstErrorElement) firstErrorElement = startTimeButton;
      }

      // ì¢…ë£Œì‹œê°„ ë“œë¡­ë‹¤ìš´ ê²€ì¦
      const endTimeButton = document.getElementById("dropdownMenu2Button");
      const existingEndError = document.getElementById("endDropdownError");
      if(existingEndError) {
        existingEndError.remove();
      }
      endTimeButton.style.border = "";
      if(endTimeButton.textContent.trim() === "ì¢…ë£Œ ì‹œê°„"){
        isValid = false;
        endTimeButton.style.border = "2px solid #d32f2f";
        endTimeButton.classList.add("shake-error");
        setTimeout(() => endTimeButton.classList.remove("shake-error"), 400);
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "endDropdownError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.whiteSpace = "nowrap";
        errorMsg.textContent = "ì¢…ë£Œì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
        endTimeButton.parentNode.style.overflow = "visible";
        endTimeButton.parentNode.insertBefore(errorMsg, endTimeButton.nextSibling);
        if (!firstErrorElement) firstErrorElement = endTimeButton;
      }

      // ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ì˜ ìˆœì„œ ê²€ì¦ : ì‹œì‘ ì‹œê°„ì´ ì¢…ë£Œ ì‹œê°„ë³´ë‹¤ ëŠ¦ì„ ê²½ìš°
      if(startTimeButton.textContent.trim() !== "ì‹œì‘ ì‹œê°„" && endTimeButton.textContent.trim() !== "ì¢…ë£Œ ì‹œê°„"){
        const startTimeValue = parseTime(startTimeButton.textContent.trim());
        const endTimeValue = parseTime(endTimeButton.textContent.trim());
        if(startTimeValue >= endTimeValue){
          isValid = false;

          // ì‹œì‘ ì‹œê°„ ì—ëŸ¬ ì²˜ë¦¬
          startTimeButton.style.border = "2px solid #d32f2f";
          startTimeButton.classList.add("shake-error");
          setTimeout(() => startTimeButton.classList.remove("shake-error"), 400);
          let errStart = document.getElementById("startDropdownError");
          if(errStart) errStart.remove();
          const errorMsgTime = document.createElement("div");
          errorMsgTime.setAttribute("id", "startDropdownError");
          errorMsgTime.style.color = "#d32f2f";
          errorMsgTime.style.fontSize = "0.75em";
          errorMsgTime.style.margin = "1px 0 0 0";
          errorMsgTime.style.whiteSpace = "nowrap";
          errorMsgTime.textContent = "ì‹œì‘ì‹œê°„ì´ ì¢…ë£Œì‹œê°„ë³´ë‹¤ ëŠ¦ì„ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
          startTimeButton.parentNode.style.overflow = "visible";
          startTimeButton.parentNode.insertBefore(errorMsgTime, startTimeButton.nextSibling);

          // ì¢…ë£Œ ì‹œê°„ ì—ëŸ¬ ì²˜ë¦¬
          endTimeButton.style.border = "2px solid #d32f2f";
          endTimeButton.classList.add("shake-error");
          setTimeout(() => endTimeButton.classList.remove("shake-error"), 400);
          let errEnd = document.getElementById("endDropdownError");
          if(errEnd) errEnd.remove();
          const errorMsgTime2 = document.createElement("div");
          errorMsgTime2.setAttribute("id", "endDropdownError");
          errorMsgTime2.style.color = "#d32f2f";
          errorMsgTime2.style.fontSize = "0.75em";
          errorMsgTime2.style.margin = "1px 0 0 0";
          errorMsgTime2.style.whiteSpace = "nowrap";
          endTimeButton.parentNode.style.overflow = "visible";
          endTimeButton.parentNode.insertBefore(errorMsgTime2, endTimeButton.nextSibling);

          if (!firstErrorElement) firstErrorElement = startTimeButton;
        }
      }

      // ë‚ ì§œ ì„ íƒ ê²€ì¦ (ìº˜ë¦°ë”)
      const calendarDiv = document.getElementById("calendar");
      const existingCalendarError = document.getElementById("calendarError");
      if(existingCalendarError) {
        existingCalendarError.remove();
      }
      calendarDiv.style.border = "";

      // localStorageì— ì €ì¥ëœ ì „ì²´ ì„ íƒëœ ë‚ ì§œ ê°œìˆ˜ë¥¼ ê³„ì‚° (ëª¨ë“  "dateSelection_" í‚¤ì—ì„œ)
      let totalSelectedCount = 0;
      for (let i = 0; i < selectedDatesMap.size; i++) {
        const key = selectedDatesMap.keys().next().value;
        const days = selectedDatesMap.get(key);
        totalSelectedCount += days.length;
      }
      
      if(totalSelectedCount === 0 || totalSelectedCount > 31){
        isValid = false;
        calendarDiv.style.border = "2px solid #d32f2f";
        calendarDiv.classList.add("shake-error");
        setTimeout(() => calendarDiv.classList.remove("shake-error"), 400);
        const errorMsg = document.createElement("div");
        errorMsg.setAttribute("id", "calendarError");
        errorMsg.style.color = "#d32f2f";
        errorMsg.style.fontSize = "0.75em";
        errorMsg.style.margin = "1px 0 0 0";
        errorMsg.style.position = "relative";
        errorMsg.textContent = "ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
        calendarDiv.parentNode.insertBefore(errorMsg, calendarDiv.nextSibling);
        if (!firstErrorElement) firstErrorElement = calendarDiv;
      }

      // ë§ˆì§€ë§‰ì— ì²« ë²ˆì§¸ ì˜¤ë¥˜ ìš”ì†Œë¡œ ìŠ¤í¬ë¡¤
      if (!isValid && firstErrorElement) {
        firstErrorElement.scrollIntoView({
          behavior: 'smooth',
          block: 'center'
        });
      }

      return isValid;
    }

    const helpBtn = document.getElementById('dateHelpBtn');
    const tooltip = document.getElementById('dateHelpTooltip');
    let isTooltipVisible = false;
    const defaultDiamondOffset = 10; // ê¸°ë³¸ê°’: tooltip ìš°ì¸¡ì—ì„œ ë–¨ì–´ì§„ ê±°ë¦¬

    function updateTooltipPosition() {
      const helpBtnRect = helpBtn.getBoundingClientRect();
      const offsetParent = tooltip.offsetParent;
      let parentLeft = 0;
      let parentWidth = window.innerWidth;
      if (offsetParent) {
        const parentRect = offsetParent.getBoundingClientRect();
        parentLeft = parentRect.left;
        parentWidth = parentRect.width;
      }
      // ë¶€ëª¨ ê¸°ì¤€ ë¬¼ìŒí‘œ ì•„ì´ì½˜ì˜ ì¤‘ì•™ xì¢Œí‘œ
      const iconCenterX = helpBtnRect.left + (helpBtnRect.width / 2) - parentLeft;

      // tooltipì´ ë³´ì¸ ìƒíƒœì—¬ì•¼ ì‹¤ì œ ë„ˆë¹„ë¥¼ ì½ì„ ìˆ˜ ìˆìŒ
      const tooltipRect = tooltip.getBoundingClientRect();

      // íˆ´í¬ ë„¤ëª¨ì˜ ìš°ì¸¡ ìƒë‹¨(ë§ˆë¦„ëª¨ ì¤‘ì‹¬ì´ 6px ì•ˆìª½)ì— ë§ì¶”ê¸° ìœ„í•œ ê¸°ë³¸ ê³„ì‚°
      let tooltipLeft = iconCenterX - tooltipRect.width + 6;

      const extraOffset = 10;  // ì˜¤ë¥¸ìª½ìœ¼ë¡œ 10px ì´ë™
      tooltipLeft += extraOffset;

      const margin = 10; // ë¶€ëª¨ ë‚´ë¶€ ìµœì†Œ ì—¬ë°±
      // ë¶€ëª¨ ì˜ì—­ì„ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ clamping
      if (tooltipLeft < margin) {
        tooltipLeft = margin;
      }
      if (tooltipLeft + tooltipRect.width > parentWidth - margin) {
        tooltipLeft = parentWidth - margin - tooltipRect.width;
      }

      // diamondì˜ ìœ„ì¹˜ ì¬ê³„ì‚°:
      // tooltip ë‚´ë¶€ì—ì„œ diamondì˜ centerëŠ”
      // tooltipRect.width - (diamondOffset + 6) ì´ì–´ì•¼ í•˜ê³ ,
      // ì´ ê°’ì´ iconCenterX - tooltipLeftì™€ ì¼ì¹˜í•´ì•¼ í•¨
      // ë”°ë¼ì„œ diamondOffset = tooltipRect.width - (iconCenterX - tooltipLeft) - 6
      const diamondOffset = tooltipRect.width - (iconCenterX - tooltipLeft) - 6;

      // ìœ„ì—ì„œ ê³„ì‚°í•œ tooltipLeftì™€ diamondOffset ê°’ì„ ì ìš©
      tooltip.style.left = `${tooltipLeft}px`;
      tooltip.style.setProperty('--diamond-offset', `${diamondOffset}px`);
    }

    // ë¬¼ìŒí‘œ ì•„ì´ì½˜ í´ë¦­ ì‹œ, íˆ´í¬ í† ê¸€ ë° ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    helpBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      isTooltipVisible = !isTooltipVisible;
      tooltip.style.display = isTooltipVisible ? 'block' : 'none';
      if (isTooltipVisible) {
        // íˆ´í¬ê°€ ë Œë”ë§ëœ í›„ ìœ„ì¹˜ ê³„ì‚°
        setTimeout(updateTooltipPosition, 0);
      }
    });

    // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ íˆ´íŒ ìœ„ì¹˜ ì¬ê³„ì‚°
    window.addEventListener('resize', function() {
      if (isTooltipVisible) updateTooltipPosition();
    });

    // íˆ´íŒ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    document.addEventListener('click', function(e) {
      if (!tooltip.contains(e.target) && e.target !== helpBtn) {
        isTooltipVisible = false;
        tooltip.style.display = 'none';
      }
    });

    // ESC í‚¤ ì…ë ¥ ì‹œ ë‹«ê¸°
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        isTooltipVisible = false;
        tooltip.style.display = 'none';
      }
    });

    // ì œëª© ì…ë ¥ í•„ë“œ ì˜¤ë¥˜ ì œê±° í•¨ìˆ˜
    function handleTitleError() {
      const titleInput = document.getElementById("titleInput");
      const titleError = document.getElementById("titleError");

      if(titleInput.value.trim() !== "") {
        // í…ìŠ¤íŠ¸ê°€ ìˆìœ¼ë©´ ì˜¤ë¥˜ ì œê±°
        titleInput.style.border = "";
        if(titleError) {
          titleError.remove();
        }
      } else {
        // í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ í‘œì‹œ
        titleInput.style.border = "2px solid #d32f2f";
        titleInput.classList.add("shake-error");
        setTimeout(() => titleInput.classList.remove("shake-error"), 400);

        if(!titleError) {
          const errorMsg = document.createElement("div");
          errorMsg.setAttribute("id", "titleError");
          errorMsg.style.color = "#d32f2f";
          errorMsg.style.fontSize = "0.75em";
          errorMsg.style.margin = "1px 0 0 0";
          errorMsg.style.position = "relative";
          errorMsg.textContent = "ì¼ì • ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";
          titleInput.parentNode.insertBefore(errorMsg, titleInput.nextSibling);
        }
      }
    }

    // ì œëª© ì…ë ¥ í•„ë“œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.getElementById("titleInput").addEventListener("input", function() {
      handleTitleError();
    });
  });



</script>

<!-- ë‘ ë²ˆì§¸ ìŠ¬ë¼ì´ë“œì— ì¶”ê°€ -->
<script>
  // ì‹œê°„í‘œ ìƒì„± í›„ ì‹œê°„ ë¼ë²¨ì„ ê°•ì œë¡œ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
  function fixTimeLabels() {
    // ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒí•œ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
    const startTimeBtn = document.getElementById("dropdownMenu1Button").textContent.trim();
    
    if (startTimeBtn && startTimeBtn !== "ì‹œì‘ ì‹œê°„") {
      // 12ì‹œê°„ì œë¥¼ 24ì‹œê°„ì œë¡œ ë³€í™˜
      const [time, period] = startTimeBtn.split(' ');
      let [hours, minutes] = time.split(':');
      hours = parseInt(hours);
      
      if (period === 'PM' && hours !== 12) {
        hours += 12;
      } else if (period === 'AM' && hours === 12) {
        hours = 0;
      }
      
      console.log("ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰: ì‹œì‘ ì‹œê°„ = " + hours + "ì‹œ");
      
      // ëª¨ë“  ì‹œê°„ ë¼ë²¨ ê°•ì œ ì—…ë°ì´íŠ¸
      const timeLabels = document.querySelectorAll(".time-label");
      timeLabels.forEach((label, index) => {
        const currentHour = (hours + index) % 24;
        const ampm = currentHour < 12 ? "ì˜¤ì „" : "ì˜¤í›„";
        const hour12 = currentHour % 12 === 0 ? 12 : currentHour % 12;
        
        label.textContent = `${ampm} ${hour12}ì‹œ`;
        console.log(`ë¼ë²¨ ${index} ìˆ˜ì •: ${currentHour}ì‹œ(24ì‹œê°„ì œ) â†’ ${ampm} ${hour12}ì‹œ`);
      });
    }
  }
  
  // ë‹¤ìŒ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ì— ì—°ê²°
  document.getElementById("nextButton").addEventListener("click", function(e) {
    // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì‹¤í–‰ëœ í›„
    setTimeout(function() {
      fixTimeLabels();
    }, 500); // ì‹œê°„í‘œê°€ ë Œë”ë§ëœ í›„ ì‹¤í–‰
  });
</script>
</body>
</html>
