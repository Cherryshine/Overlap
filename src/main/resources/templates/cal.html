<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>OverLap - Î©îÏù∏ ÎûúÎî©ÌéòÏù¥ÏßÄ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
    <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Roboto', sans-serif;
            background-color: #f4f4f8;
            background-size: 100% auto;
            background-repeat: no-repeat;
            min-height: 100%;
        }

        body, html {
            height: auto;
            margin: 0;
            display: flex;
            flex-direction: column;
        }

        .glass-effect { 
            background: rgba(255, 255, 255, 0.2); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.3); 
            border-radius: 1rem;
        }

        #calendar {
            width: 350px;
            margin: 50px auto;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        .calendar-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .calendar-nav button {
            background-color: #e1bee7;
            border: none;
            color: #4a148c;
            font-size: 1em;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-nav button:hover {
            background-color: #d1aee7;
        }

        .today-btn {
            background-color: #e1bee7;
            border: none;
            color: #4a148c;
            font-size: 1em;
            cursor: pointer;
            margin: 10px auto 0;
            padding: 5px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
            display: block;
        }

        .today-btn:hover {
            background-color: #d1aee7;
        }

        .calendar-header {
            font-size: 1.4em;
            color: #4a148c;
            text-align: center;
            flex-grow: 1;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 3px;
            table-layout: fixed;
        }

        thead {
            position: relative;
            border-bottom: none;
        }

        thead::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            border-bottom: 1px solid #ddd;
        }

        th, td {
            width: 40px;
            height: 40px;
            padding: 0;
            margin: 0;
            text-align: center;
            vertical-align: middle;
            user-select: none;
            cursor: pointer;
            box-sizing: border-box;
        }

        th {
            background-color: transparent;
            font-weight: normal;
            border: none;
        }

        thead th:nth-child(1) {
            color: red;
        }

        thead th:nth-child(7) {
            color: blue;
        }

        td.empty {
            background-color: transparent;
            cursor: default;
        }

        td.day {
            position: relative;
            overflow: visible;
            padding: 0;
        }

        .circle {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            border-radius: 50%;
            text-align: center;
            background-color: #fff;
            transition: background-color 0.3s, color 0.3s;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
        }

        td.day:hover .circle {
            background-color: #f3e5f5;
        }

        td.day.selected .circle {
            background-color: transparent;
            color: #fff;
            position: relative;
            z-index: 1;
        }

        td.day.selected .circle::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 40px;
            height: 40px;
            background-color: rgba(156,39,176,0.5);
            border-radius: 50%;
            z-index: -1;
            transition: all 0.3s;
        }

        td.day.today .circle {
            border: 2px solid #4a148c;
            box-sizing: border-box;
        }

        td.day.today.selected .circle::before {
            top: 2px;
            left: 2px;
            width: calc(100% - 4px);
            height: calc(100% - 4px);
        }

        td.day.group-start .circle {
            width: calc(40px + 3px);
            margin-left: -3px;
            border-radius: 50% 0 0 50%;
        }

        td.day.group-end .circle {
            width: calc(40px + 3px);
            margin-right: -3px;
            border-radius: 0 50% 50% 0;
        }

        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
            100% { transform: translateY(0); }
        }

        .logo-animation {
            animation: float 2s ease-in-out infinite;
        }

        .content {
            flex-grow: 1;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-200 via-purple-300 to-purple-400">
    <nav class="fixed top-0 left-0 w-full px-6 py-4 flex items-center z-50" style="background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3);">
        <a href="/">
            <img src="/images/overlap_logo.png" alt="OverLap" class="w-24 md:w-32 lg:w-40 h-auto logo-animation cursor-pointer">
        </a>
    </nav>

    <div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-[60px] pt-[84px] sm:pt-[150px] pb-[50px] min-h-[calc(100vh-80px)] max-w-4xl">
        <div class="glass-effect rounded-3xl p-8">
            <p class="text-purple-800 font-bold mb-[15px]">ÏÉà ÏùºÏ†ï ÎßåÎì§Í∏∞</p>
            <input type="text" id="titleInput" class="w-full bg-white bg-opacity-20 border-0 rounded-lg p-3 text-purple-800 mt-[10px] mb-[10px] placeholder-purple-800" placeholder="ÏùºÏ†ï Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required/>
            
            <div id="calendar">
                <div class="calendar-nav">
                    <button id="prevBtn" aria-label="Ïù¥Ï†Ñ Îã¨">
                        <svg width="16" height="16" viewBox="0 0 16 16">
                            <polyline points="10,3 5,8 10,13" fill="none" stroke="#4a148c" stroke-width="2"/>
                        </svg>
                    </button>
                    <div class="calendar-header" id="calendarHeader"></div>
                    <button id="nextBtn" aria-label="Îã§Ïùå Îã¨">
                        <svg width="16" height="16" viewBox="0 0 16 16">
                            <polyline points="6,3 11,8 6,13" fill="none" stroke="#4a148c" stroke-width="2"/>
                        </svg>
                    </button>
                </div>
                <table id="calendarTable"></table>
                <button id="todayBtn" class="today-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" style="vertical-align:middle;margin-right:5px;">
                        <circle cx="8" cy="8" r="7" fill="none" stroke="#4a148c" stroke-width="2"/>
                    </svg>
                    Ïò§Îäò
                </button>
            </div>
        </div>
    </div>

    <footer class="bg-purple-800 text-white py-6">
        <div class="container mx-auto text-center">
            <p class="text-sm">&copy; Made with üíú by ÌçºÌîåÏΩîÎìúÎû©Ïä§</p>
        </div>
    </footer>

    <script>
        (function(){
            const calendarTable = document.getElementById("calendarTable");
            const header = document.getElementById("calendarHeader");
            const todayDate = new Date();
            let currentYear = todayDate.getFullYear();
            let currentMonth = todayDate.getMonth();

            function getSelectionKey(year, month) {
                return year + "-" + (month + 1);
            }

            function saveCurrentSelection() {
                const key = getSelectionKey(currentYear, currentMonth);
                const selections = [];
                const dayCells = calendarTable.querySelectorAll("td.day");
                dayCells.forEach(cell => {
                    if(cell.classList.contains("selected")) {
                        selections.push(cell.dataset.date);
                    }
                });
                localStorage.setItem(key, JSON.stringify(selections));
            }

            function loadSelections(year, month) {
                const key = getSelectionKey(year, month);
                let selections = JSON.parse(localStorage.getItem(key));
                if(selections && selections.length) {
                    const dayCells = calendarTable.querySelectorAll("td.day");
                    dayCells.forEach(cell => {
                        if(selections.indexOf(cell.dataset.date) !== -1) {
                            cell.classList.add("selected");
                        } else {
                            cell.classList.remove("selected");
                        }
                    });
                }
            }

            function renderCalendar(year, month) {
                const monthNames = ["1Ïõî", "2Ïõî", "3Ïõî", "4Ïõî", "5Ïõî", "6Ïõî", "7Ïõî", "8Ïõî", "9Ïõî", "10Ïõî", "11Ïõî", "12Ïõî"];
                header.textContent = year + "ÎÖÑ " + monthNames[month];

                calendarTable.innerHTML = "";

                const thead = document.createElement("thead");
                const headerRow = document.createElement("tr");
                const weekDays = ["Ïùº", "Ïõî", "Ìôî", "Ïàò", "Î™©", "Í∏à", "ÌÜ†"];
                weekDays.forEach(day => {
                    const th = document.createElement("th");
                    th.textContent = day;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                calendarTable.appendChild(thead);

                const tbody = document.createElement("tbody");

                const firstDay = new Date(year, month, 1).getDay();
                const totalDays = new Date(year, month + 1, 0).getDate();

                let date = 1;
                for(let i = 0; i < 6; i++){
                    const tr = document.createElement("tr");
                    for(let j = 0; j < 7; j++){
                        const td = document.createElement("td");
                        if(i === 0 && j < firstDay) {
                            td.className = "empty";
                            td.textContent = "";
                        } else if(date > totalDays) {
                            td.className = "empty";
                            td.textContent = "";
                        } else {
                            td.dataset.date = date;
                            td.classList.add("day");
                            const circle = document.createElement("div");
                            circle.classList.add("circle");
                            circle.textContent = date;
                            td.appendChild(circle);
                            if(year === todayDate.getFullYear() && month === todayDate.getMonth() && date === todayDate.getDate()){
                                td.classList.add("today");
                            }
                            date++;
                        }
                        tr.appendChild(td);
                    }
                    tbody.appendChild(tr);
                }
                calendarTable.appendChild(tbody);

                loadSelections(year, month);
            }

            renderCalendar(currentYear, currentMonth);

            document.getElementById("prevBtn").addEventListener("click", function(){
                saveCurrentSelection();
                currentMonth--;
                if(currentMonth < 0){
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar(currentYear, currentMonth);
            });

            document.getElementById("nextBtn").addEventListener("click", function(){
                saveCurrentSelection();
                currentMonth++;
                if(currentMonth > 11){
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar(currentYear, currentMonth);
            });

            document.getElementById("todayBtn").addEventListener("click", function(){
                saveCurrentSelection();
                currentYear = todayDate.getFullYear();
                currentMonth = todayDate.getMonth();
                renderCalendar(currentYear, currentMonth);
            });

            let isMouseDown = false;
            let isTouchActive = false;
            let dragStartDay = null;
            let dragMode = "add";
            let initialSelected = new Map();

            function findDayCell(target) {
                if(target.classList.contains("day")) return target;
                if(target.parentElement && target.parentElement.classList.contains("day")) return target.parentElement;
                return null;
            }

            function handleDragStart(e) {
                const touch = e.type.includes('touch') ? e.touches[0] : e;
                const dayCell = findDayCell(document.elementFromPoint(touch.clientX, touch.clientY));
                
                if(dayCell && dayCell.classList.contains("day")){
                    isMouseDown = true;
                    isTouchActive = e.type.includes('touch');
                    dragStartDay = parseInt(dayCell.dataset.date);
                    initialSelected.clear();
                    
                    const dayCells = calendarTable.querySelectorAll("td.day");
                    dayCells.forEach(cell => {
                        initialSelected.set(cell, cell.classList.contains("selected"));
                    });
                    
                    dragMode = dayCell.classList.contains("selected") ? "remove" : "add";
                    if(dragMode === "add") {
                        dayCell.classList.add("selected");
                    } else {
                        dayCell.classList.remove("selected");
                    }
                    e.preventDefault();
                }
            }

            function handleDragMove(e) {
                if(!isMouseDown) return;
                
                const touch = e.type.includes('touch') ? e.touches[0] : e;
                const dayCell = findDayCell(document.elementFromPoint(touch.clientX, touch.clientY));
                
                if(dayCell && dayCell.classList.contains("day")) {
                    const currentDay = parseInt(dayCell.dataset.date);
                    const minDay = Math.min(dragStartDay, currentDay);
                    const maxDay = Math.max(dragStartDay, currentDay);
                    
                    const dayCells = calendarTable.querySelectorAll("td.day");
                    dayCells.forEach(cell => {
                        const cellDay = parseInt(cell.dataset.date);
                        if(cellDay >= minDay && cellDay <= maxDay) {
                            if(dragMode === "add") {
                                cell.classList.add("selected");
                            } else {
                                cell.classList.remove("selected");
                            }
                        } else {
                            if(initialSelected.get(cell)){
                                cell.classList.add("selected");
                            } else {
                                cell.classList.remove("selected");
                            }
                        }
                    });
                }
                e.preventDefault();
            }

            function handleDragEnd() {
                if(isMouseDown){
                    isMouseDown = false;
                    isTouchActive = false;
                    dragStartDay = null;
                    initialSelected.clear();
                    saveCurrentSelection();
                }
            }

            calendarTable.addEventListener("mousedown", handleDragStart);
            calendarTable.addEventListener("mousemove", handleDragMove);
            document.addEventListener("mouseup", handleDragEnd);

            calendarTable.addEventListener("touchstart", handleDragStart, { passive: false });
            calendarTable.addEventListener("touchmove", handleDragMove, { passive: false });
            document.addEventListener("touchend", handleDragEnd);
            document.addEventListener("touchcancel", handleDragEnd);

        })();
    </script>
</body>
</html>